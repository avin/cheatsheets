/*
 * ============================================
 * ĞĞ‘Ğ ĞĞ‘ĞĞ¢ĞšĞ ĞĞ¨Ğ˜Ğ‘ĞĞš Ğ’ MODERN C++
 * ============================================
 * 
 * ĞšĞ¾Ğ¼Ğ¿Ğ»ĞµĞºÑĞ½Ğ¾Ğµ Ñ€ÑƒĞºĞ¾Ğ²Ğ¾Ğ´ÑÑ‚Ğ²Ğ¾ Ğ¿Ğ¾ Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞµ Ğ¾ÑˆĞ¸Ğ±Ğ¾Ğº:
 * - Ğ˜ÑĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ñ (exceptions)
 * - std::expected<T, E> (C++23)
 * - std::optional<T> (C++17)
 * - Error codes
 * - RAII Ğ¿Ğ°Ñ‚Ñ‚ĞµÑ€Ğ½Ñ‹
 * 
 * Ğ¢Ñ€ĞµĞ±Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ: C++23 Ğ´Ğ»Ñ std::expected
 * ĞšĞ¾Ğ¼Ğ¿Ğ¸Ğ»ÑÑ†Ğ¸Ñ: g++ -std=c++23 error_handling.cpp
 */

#include <iostream>
#include <string>
#include <memory>
#include <stdexcept>
#include <optional>
#include <system_error>
#include <fstream>
#include <vector>
#include <functional>

// C++23 expected (ĞµÑĞ»Ğ¸ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ğ¾)
#if __has_include(<expected>)
#include <expected>
#define HAS_EXPECTED 1
#else
#define HAS_EXPECTED 0
// Ğ£Ğ¿Ñ€Ğ¾Ñ‰ĞµĞ½Ğ½Ğ°Ñ Ñ€ĞµĞ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ğ´Ğ»Ñ Ğ´ĞµĞ¼Ğ¾Ğ½ÑÑ‚Ñ€Ğ°Ñ†Ğ¸Ğ¸
namespace std {
    template<typename T, typename E>
    class expected {
        union {
            T value_;
            E error_;
        };
        bool has_value_;
        
    public:
        expected(T value) : value_(std::move(value)), has_value_(true) {}
        expected(E error) : error_(std::move(error)), has_value_(false) {}
        
        ~expected() {
            if (has_value_) {
                value_.~T();
            } else {
                error_.~E();
            }
        }
        
        bool has_value() const { return has_value_; }
        
        T& value() {
            if (!has_value_) throw std::bad_expected_access<E>(error_);
            return value_;
        }
        
        const T& value() const {
            if (!has_value_) throw std::bad_expected_access<E>(error_);
            return value_;
        }
        
        E& error() { return error_; }
        const E& error() const { return error_; }
        
        T value_or(T default_value) const {
            return has_value_ ? value_ : default_value;
        }
        
        explicit operator bool() const { return has_value_; }
    };
}
#endif

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ğŸ“Œ EXCEPTION BASICS (ĞĞ¡ĞĞĞ’Ğ« Ğ˜Ğ¡ĞšĞ›Ğ®Ğ§Ğ•ĞĞ˜Ğ™)
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

/*
 * Ğ¡Ñ‚Ğ°Ğ½Ğ´Ğ°Ñ€Ñ‚Ğ½Ğ°Ñ Ğ¸ĞµÑ€Ğ°Ñ€Ñ…Ğ¸Ñ Ğ¸ÑĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğ¹:
 * 
 * std::exception (Ğ±Ğ°Ğ·Ğ¾Ğ²Ñ‹Ğ¹ ĞºĞ»Ğ°ÑÑ)
 *   â”œâ”€ std::logic_error (Ğ¿Ñ€Ğ¾Ğ³Ñ€Ğ°Ğ¼Ğ¼Ğ½Ñ‹Ğµ Ğ¾ÑˆĞ¸Ğ±ĞºĞ¸)
 *   â”‚    â”œâ”€ std::invalid_argument
 *   â”‚    â”œâ”€ std::domain_error
 *   â”‚    â”œâ”€ std::length_error
 *   â”‚    â”œâ”€ std::out_of_range
 *   â”‚    â””â”€ std::future_error
 *   â””â”€ std::runtime_error (Ğ¾ÑˆĞ¸Ğ±ĞºĞ¸ Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ñ)
 *        â”œâ”€ std::range_error
 *        â”œâ”€ std::overflow_error
 *        â”œâ”€ std::underflow_error
 *        â””â”€ std::system_error
 */

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒÑĞºĞ¾Ğ³Ğ¾ Ğ¸ÑĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ñ
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

class DatabaseError : public std::runtime_error {
    int error_code_;
    
public:
    DatabaseError(const std::string& message, int code)
        : std::runtime_error(message), error_code_(code) {}
    
    int code() const { return error_code_; }
};

// Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ:
// throw DatabaseError("Connection failed", 1001);

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// Ğ‘Ğ°Ğ·Ğ¾Ğ²Ñ‹Ğ¹ try-catch
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

try {
    // ĞšĞ¾Ğ´, ĞºĞ¾Ñ‚Ğ¾Ñ€Ñ‹Ğ¹ Ğ¼Ğ¾Ğ¶ĞµÑ‚ Ğ±Ñ€Ğ¾ÑĞ¸Ñ‚ÑŒ Ğ¸ÑĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ
    throw std::runtime_error("Something went wrong");
    
} catch (const std::exception& e) {  // âœ… Ğ›Ğ¾Ğ²Ğ¸Ğ¼ Ğ¿Ğ¾ const reference
    // ĞĞ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ° Ğ¸ÑĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ñ
    std::string message = e.what();
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// ĞœĞ½Ğ¾Ğ¶ĞµÑÑ‚Ğ²ĞµĞ½Ğ½Ñ‹Ğµ catch Ğ±Ğ»Ğ¾ĞºĞ¸ - Ğ¿Ğ¾Ñ€ÑĞ´Ğ¾Ğº Ğ²Ğ°Ğ¶ĞµĞ½!
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

try {
    // throw std::invalid_argument("Bad argument");
    // throw DatabaseError("DB error", 500);
    // throw 42;  // âŒ ĞĞµ Ñ€ĞµĞºĞ¾Ğ¼ĞµĞ½Ğ´ÑƒĞµÑ‚ÑÑ Ğ±Ñ€Ğ¾ÑĞ°Ñ‚ÑŒ Ğ½Ğµ-exception Ñ‚Ğ¸Ğ¿Ñ‹
    
} catch (const DatabaseError& e) {
    // âœ… Ğ¡Ğ¿ĞµÑ†Ğ¸Ñ„Ğ¸Ñ‡Ğ½Ñ‹Ğµ Ğ¸ÑĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ñ Ğ»Ğ¾Ğ²Ğ¸Ğ¼ ĞŸĞ•Ğ Ğ’Ğ«ĞœĞ˜
    // int code = e.code();
    
} catch (const std::invalid_argument& e) {
    // ĞĞ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ° invalid_argument
    
} catch (const std::exception& e) {
    // âœ… Ğ‘Ğ°Ğ·Ğ¾Ğ²Ñ‹Ğ¹ ĞºĞ»Ğ°ÑÑ Ğ»Ğ¾Ğ²Ğ¸Ğ¼ ĞŸĞĞ¡Ğ›Ğ•Ğ”ĞĞ˜Ğœ
    // ĞŸĞ¾Ğ¹Ğ¼Ğ°ĞµÑ‚ Ğ²ÑĞµ std::exception Ğ¸ Ğ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´Ğ½Ñ‹Ğµ
    
} catch (...) {
    // Ğ›Ğ¾Ğ²Ğ¸Ñ‚ Ğ’Ğ¡Ğ Ğ¾ÑÑ‚Ğ°Ğ»ÑŒĞ½Ğ¾Ğµ (Ğ´Ğ°Ğ¶Ğµ Ğ½Ğµ-exception Ñ‚Ğ¸Ğ¿Ñ‹)
    // Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞ¹Ñ‚Ğµ Ğ¾ÑÑ‚Ğ¾Ñ€Ğ¾Ğ¶Ğ½Ğ¾!
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// Rethrow - Ğ¿ĞµÑ€ĞµĞ±Ñ€Ğ°ÑÑ‹Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ¸ÑĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğ¹
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

void inner_function() {
    throw std::runtime_error("Error in inner");
}

void outer_function() {
    try {
        inner_function();
        
    } catch (const std::exception& e) {
        // Ğ›Ğ¾Ğ³Ğ¸Ñ€ÑƒĞµĞ¼ Ğ¸Ğ»Ğ¸ Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ°Ñ‚Ñ‹Ğ²Ğ°ĞµĞ¼
        // std::cerr << "Caught: " << e.what() << '\n';
        
        // âœ… ĞŸĞµÑ€ĞµĞ±Ñ€Ğ°ÑÑ‹Ğ²Ğ°ĞµĞ¼ Ğ¢Ğ Ğ–Ğ• Ğ¸ÑĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ (ÑĞ¾Ñ…Ñ€Ğ°Ğ½ÑĞµÑ‚ Ñ‚Ğ¸Ğ¿)
        throw;
        
        // âŒ ĞŸĞ›ĞĞ¥Ğ: throw e; - ÑĞ¾Ğ·Ğ´Ğ°ÑÑ‚ ĞšĞĞŸĞ˜Ğ®, Ğ¼Ğ¾Ğ¶ĞµÑ‚ ÑÑ€ĞµĞ·Ğ°Ñ‚ÑŒ Ñ‚Ğ¸Ğ¿ (slicing)!
    }
}

// Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ:
try {
    outer_function();
} catch (const std::exception& e) {
    // ĞŸĞ¾Ğ¹Ğ¼Ğ°ĞµÑ‚ Ğ¸ÑĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ Ğ¸Ğ· inner_function
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// noexcept - Ğ³Ğ°Ñ€Ğ°Ğ½Ñ‚Ğ¸Ñ Ğ¾Ñ‚ÑÑƒÑ‚ÑÑ‚Ğ²Ğ¸Ñ Ğ¸ÑĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğ¹
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

void safe_function() noexcept {
    // Ğ­Ñ‚Ğ° Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ñ Ğ½Ğµ Ğ±Ñ€Ğ¾ÑĞ°ĞµÑ‚ Ğ¸ÑĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ñ
    // Ğ•ÑĞ»Ğ¸ Ğ²ÑÑ‘ Ğ¶Ğµ Ğ±Ñ€Ğ¾ÑĞ¸Ñ‚ - std::terminate()!
}

// Ğ£ÑĞ»Ğ¾Ğ²Ğ½Ñ‹Ğ¹ noexcept
template<typename T>
void swap(T& a, T& b) noexcept(std::is_nothrow_move_constructible_v<T>) {
    T temp = std::move(a);
    a = std::move(b);
    b = std::move(temp);
}

// noexcept ĞĞ‘Ğ¯Ğ—ĞĞ¢Ğ•Ğ›Ğ•Ğ Ğ´Ğ»Ñ:
// - Ğ”ĞµÑÑ‚Ñ€ÑƒĞºÑ‚Ğ¾Ñ€Ğ¾Ğ² (Ğ¿Ğ¾ ÑƒĞ¼Ğ¾Ğ»Ñ‡Ğ°Ğ½Ğ¸Ñ noexcept)
// - Move ĞºĞ¾Ğ½ÑÑ‚Ñ€ÑƒĞºÑ‚Ğ¾Ñ€Ğ¾Ğ²/Ğ¾Ğ¿ĞµÑ€Ğ°Ñ‚Ğ¾Ñ€Ğ¾Ğ² (Ğ´Ğ»Ñ Ğ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚Ğ¸)
// - Swap Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¹

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// std::current_exception() Ğ¸ std::rethrow_exception()
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

std::exception_ptr captured_exception;

try {
    throw std::runtime_error("Error to capture");
    
} catch (...) {
    // Ğ—Ğ°Ñ…Ğ²Ğ°Ñ‚Ñ‹Ğ²Ğ°ĞµĞ¼ Ñ‚ĞµĞºÑƒÑ‰ĞµĞµ Ğ¸ÑĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ
    captured_exception = std::current_exception();
}

// ĞŸĞ¾Ğ·Ğ¶Ğµ, Ğ²Ğ¾Ğ·Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ Ğ² Ğ´Ñ€ÑƒĞ³Ğ¾Ğ¼ Ğ¿Ğ¾Ñ‚Ğ¾ĞºĞµ:
if (captured_exception) {
    try {
        std::rethrow_exception(captured_exception);
    } catch (const std::exception& e) {
        // ĞĞ±Ñ€Ğ°Ğ±Ğ°Ñ‚Ñ‹Ğ²Ğ°ĞµĞ¼ Ğ·Ğ°Ñ…Ğ²Ğ°Ñ‡ĞµĞ½Ğ½Ğ¾Ğµ Ğ¸ÑĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ
    }
}


// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ğŸ“Œ EXCEPTION SAFETY GUARANTEES (Ğ“ĞĞ ĞĞĞ¢Ğ˜Ğ˜ Ğ‘Ğ•Ğ—ĞĞŸĞĞ¡ĞĞĞ¡Ğ¢Ğ˜)
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

/*
 * Ğ§Ğ•Ğ¢Ğ«Ğ Ğ• Ğ£Ğ ĞĞ’ĞĞ¯ EXCEPTION SAFETY:
 * 
 * 1. NO-THROW GUARANTEE (noexcept)
 *    - ĞĞ¿ĞµÑ€Ğ°Ñ†Ğ¸Ñ Ğ½Ğ¸ĞºĞ¾Ğ³Ğ´Ğ° Ğ½Ğµ Ğ±Ñ€Ğ¾ÑĞ°ĞµÑ‚ Ğ¸ÑĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ñ
 *    - ĞŸÑ€Ğ¸Ğ¼ĞµÑ€: Ğ´ĞµÑÑ‚Ñ€ÑƒĞºÑ‚Ğ¾Ñ€Ñ‹, move Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸, swap
 * 
 * 2. STRONG EXCEPTION SAFETY
 *    - Ğ›Ğ¸Ğ±Ğ¾ Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸Ñ ÑƒÑĞ¿ĞµÑˆĞ½Ğ°, Ğ»Ğ¸Ğ±Ğ¾ ÑĞ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ğµ Ğ½Ğµ Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¾
 *    - Ğ¢Ñ€Ğ°Ğ½Ğ·Ğ°ĞºÑ†Ğ¸Ğ¾Ğ½Ğ½Ğ°Ñ ÑĞµĞ¼Ğ°Ğ½Ñ‚Ğ¸ĞºĞ° (commit Ğ¸Ğ»Ğ¸ rollback)
 *    - ĞŸÑ€Ğ¸Ğ¼ĞµÑ€: copy-and-swap idiom
 * 
 * 3. BASIC EXCEPTION SAFETY
 *    - Ğ˜Ğ½Ğ²Ğ°Ñ€Ğ¸Ğ°Ğ½Ñ‚Ñ‹ ÑĞ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ñ‹, Ñ€ĞµÑÑƒÑ€ÑÑ‹ Ğ½Ğµ ÑƒÑ‚ĞµĞºĞ°ÑÑ‚
 *    - ĞĞ¾ ÑĞ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ğµ Ğ¼Ğ¾Ğ¶ĞµÑ‚ Ğ¸Ğ·Ğ¼ĞµĞ½Ğ¸Ñ‚ÑŒÑÑ
 *    - ĞœĞ¸Ğ½Ğ¸Ğ¼Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ¿Ñ€Ğ¸ĞµĞ¼Ğ»ĞµĞ¼Ñ‹Ğ¹ ÑƒÑ€Ğ¾Ğ²ĞµĞ½ÑŒ
 * 
 * 4. NO EXCEPTION SAFETY
 *    - ĞĞ¸ĞºĞ°ĞºĞ¸Ñ… Ğ³Ğ°Ñ€Ğ°Ğ½Ñ‚Ğ¸Ğ¹ (Ğ¿Ğ»Ğ¾Ñ…Ğ¾!)
 *    - Ğ£Ñ‚ĞµÑ‡ĞºĞ¸ Ñ€ĞµÑÑƒÑ€ÑĞ¾Ğ², ÑĞ»Ğ¾Ğ¼Ğ°Ğ½Ğ½Ñ‹Ğµ Ğ¸Ğ½Ğ²Ğ°Ñ€Ğ¸Ğ°Ğ½Ñ‚Ñ‹
 */

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// ĞŸÑ€Ğ¸Ğ¼ĞµÑ€ ĞºĞ»Ğ°ÑÑĞ° Ñ Ñ€Ğ°Ğ·Ğ½Ñ‹Ğ¼Ğ¸ Ğ³Ğ°Ñ€Ğ°Ğ½Ñ‚Ğ¸ÑĞ¼Ğ¸
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

class Widget {
    std::string name_;
    std::vector<int> data_;
    
public:
    // âœ… STRONG EXCEPTION SAFETY Ñ‡ĞµÑ€ĞµĞ· copy-and-swap idiom
    Widget& operator=(const Widget& other) {
        Widget temp(other);  // ĞœĞ¾Ğ¶ĞµÑ‚ Ğ±Ñ€Ğ¾ÑĞ¸Ñ‚ÑŒ, Ğ½Ğ¾ this Ğ½Ğµ Ñ‚Ñ€Ğ¾Ğ½ÑƒÑ‚
        swap(temp);          // noexcept - Ğ³Ğ°Ñ€Ğ°Ğ½Ñ‚Ğ¸Ñ
        return *this;
        // Ğ•ÑĞ»Ğ¸ ĞºĞ¾Ğ½ÑÑ‚Ñ€ÑƒĞºÑ‚Ğ¾Ñ€ temp Ğ±Ñ€Ğ¾ÑĞ¸Ğ» â†’ this Ğ½Ğµ Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½
        // Ğ•ÑĞ»Ğ¸ swap ÑƒÑĞ¿ĞµÑˆĞµĞ½ â†’ Ğ°Ñ‚Ğ¾Ğ¼Ğ°Ñ€Ğ½Ğ°Ñ Ğ·Ğ°Ğ¼ĞµĞ½Ğ°
    }
    
    // âœ… NO-THROW GUARANTEE Ğ´Ğ»Ñ move
    Widget& operator=(Widget&& other) noexcept {
        name_ = std::move(other.name_);
        data_ = std::move(other.data_);
        return *this;
    }
    
    void swap(Widget& other) noexcept {
        name_.swap(other.name_);
        data_.swap(other.data_);
    }
    
    // âœ… BASIC EXCEPTION SAFETY
    void add_element(int value) {
        data_.push_back(value);  // ĞœĞ¾Ğ¶ĞµÑ‚ Ğ±Ñ€Ğ¾ÑĞ¸Ñ‚ÑŒ
        // Ğ•ÑĞ»Ğ¸ Ğ±Ñ€Ğ¾ÑĞ¸Ğ»Ğ¾ â†’ data_ Ğ² Ğ²Ğ°Ğ»Ğ¸Ğ´Ğ½Ğ¾Ğ¼ ÑĞ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ğ¸ (ÑÑ‚Ğ°Ñ€Ğ¾Ğµ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ)
        // Ğ•ÑĞ»Ğ¸ ÑƒÑĞ¿ĞµÑ… â†’ data_ Ñ Ğ½Ğ¾Ğ²Ñ‹Ğ¼ ÑĞ»ĞµĞ¼ĞµĞ½Ñ‚Ğ¾Ğ¼
    }
    
    // âœ… NO-THROW Ğ´Ğ»Ñ Ğ´ĞµÑÑ‚Ñ€ÑƒĞºÑ‚Ğ¾Ñ€Ğ° (Ğ¿Ğ¾ ÑƒĞ¼Ğ¾Ğ»Ñ‡Ğ°Ğ½Ğ¸Ñ noexcept)
    ~Widget() noexcept {
        // Ğ”ĞµÑÑ‚Ñ€ÑƒĞºÑ‚Ğ¾Ñ€Ñ‹ ĞĞ˜ĞšĞĞ“Ğ”Ğ Ğ½Ğµ Ğ´Ğ¾Ğ»Ğ¶Ğ½Ñ‹ Ğ±Ñ€Ğ¾ÑĞ°Ñ‚ÑŒ Ğ¸ÑĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ñ!
        // Ğ•ÑĞ»Ğ¸ Ğ´ĞµÑÑ‚Ñ€ÑƒĞºÑ‚Ğ¾Ñ€ Ğ±Ñ€Ğ¾ÑĞ°ĞµÑ‚ Ğ²Ğ¾ Ğ²Ñ€ĞµĞ¼Ñ Ñ€Ğ°ÑĞºÑ€ÑƒÑ‚ĞºĞ¸ ÑÑ‚ĞµĞºĞ° â†’ std::terminate()
    }
};

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// Strong guarantee: Ñ‚Ñ€Ğ°Ğ½Ğ·Ğ°ĞºÑ†Ğ¸Ğ¾Ğ½Ğ½Ğ°Ñ ÑĞµĞ¼Ğ°Ğ½Ñ‚Ğ¸ĞºĞ°
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

class BankAccount {
    double balance_;
    std::string owner_;
    
public:
    // âŒ Ğ‘Ğ•Ğ— strong guarantee
    void transfer_bad(BankAccount& target, double amount) {
        balance_ -= amount;        // Ğ˜Ğ·Ğ¼ĞµĞ½Ğ¸Ğ»Ğ¸ this
        target.balance_ += amount; // ĞœĞ¾Ğ¶ĞµÑ‚ Ğ±Ñ€Ğ¾ÑĞ¸Ñ‚ÑŒ!
        // Ğ•ÑĞ»Ğ¸ Ğ±Ñ€Ğ¾ÑĞ¸Ğ»Ğ¾ â†’ Ğ´ĞµĞ½ÑŒĞ³Ğ¸ Ğ¿Ğ¾Ñ‚ĞµÑ€ÑĞ½Ñ‹ (Ğ² this Ğ²Ñ‹Ñ‡Ğ»Ğ¸, Ğ² target Ğ½Ğµ Ğ´Ğ¾Ğ±Ğ°Ğ²Ğ¸Ğ»Ğ¸)
    }
    
    // âœ… Strong guarantee
    void transfer_good(BankAccount& target, double amount) {
        if (balance_ < amount) {
            throw std::runtime_error("Insufficient funds");
        }
        
        // Ğ’ÑĞµ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ¸ Ğ”Ğ Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ñ ÑĞ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ñ
        double new_balance = balance_ - amount;
        double new_target_balance = target.balance_ + amount;
        
        // ĞÑ‚Ğ¾Ğ¼Ğ°Ñ€Ğ½Ğ¾Ğµ Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ğµ (Ğ¸Ğ»Ğ¸ noexcept Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸)
        balance_ = new_balance;
        target.balance_ = new_target_balance;
        // Ğ•ÑĞ»Ğ¸ Ñ‡Ñ‚Ğ¾-Ñ‚Ğ¾ Ğ¿Ğ¾Ğ¹Ğ´ĞµÑ‚ Ğ½Ğµ Ñ‚Ğ°Ğº â†’ ÑĞ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ğµ Ğ½Ğµ Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¾
    }
};

// Conditional noexcept
template<typename T>
class Container {
    T value_;
    
public:
    // noexcept ĞµÑĞ»Ğ¸ T::T(T&&) noexcept
    Container(Container&& other) noexcept(std::is_nothrow_move_constructible_v<T>)
        : value_(std::move(other.value_)) {}
    
    // ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° noexcept-ÑĞ²Ğ¾Ğ¹ÑÑ‚Ğ²
    void swap(Container& other) noexcept(noexcept(std::swap(value_, other.value_))) {
        std::swap(value_, other.value_);
    }
};

void demo_noexcept() {
    std::cout << "\n=== noexcept Examples ===\n";
    
    // noexcept operator - compile-time Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ°
    std::cout << "Widget move is noexcept: " 
              << std::boolalpha 
              << noexcept(Widget(std::declval<Widget&&>())) << '\n';
    
    // Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ noexcept Ğ´Ğ»Ñ Ğ¾Ğ¿Ñ‚Ğ¸Ğ¼Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¹
    std::vector<Widget> widgets;
    widgets.reserve(10);
    
    // Ğ•ÑĞ»Ğ¸ move noexcept, std::vector Ğ±ÑƒĞ´ĞµÑ‚ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ÑŒ move Ğ¿Ñ€Ğ¸ Ñ€ĞµĞ°Ğ»Ğ»Ğ¾ĞºĞ°Ñ†Ğ¸Ğ¸
    // Ğ˜Ğ½Ğ°Ñ‡Ğµ Ğ±ÑƒĞ´ĞµÑ‚ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ÑŒ copy Ğ´Ğ»Ñ exception safety
}

void demo() {
    demo_noexcept();
}


// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ğŸ“Œ RAII PATTERN (ĞŸĞĞ¢Ğ¢Ğ•Ğ Ğ RAII)
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

/*
 * RAII = Resource Acquisition Is Initialization
 * 
 * ĞŸĞ Ğ˜ĞĞ¦Ğ˜ĞŸĞ«:
 * - Ğ—Ğ°Ñ…Ğ²Ğ°Ñ‚ Ñ€ĞµÑÑƒÑ€ÑĞ° = Ğ¸Ğ½Ğ¸Ñ†Ğ¸Ğ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ Ğ¾Ğ±ÑŠĞµĞºÑ‚Ğ° (ĞºĞ¾Ğ½ÑÑ‚Ñ€ÑƒĞºÑ‚Ğ¾Ñ€)
 * - ĞÑĞ²Ğ¾Ğ±Ğ¾Ğ¶Ğ´ĞµĞ½Ğ¸Ğµ Ñ€ĞµÑÑƒÑ€ÑĞ° = ÑƒĞ½Ğ¸Ñ‡Ñ‚Ğ¾Ğ¶ĞµĞ½Ğ¸Ğµ Ğ¾Ğ±ÑŠĞµĞºÑ‚Ğ° (Ğ´ĞµÑÑ‚Ñ€ÑƒĞºÑ‚Ğ¾Ñ€)
 * - ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¾Ğµ ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ²Ñ€ĞµĞ¼ĞµĞ½ĞµĞ¼ Ğ¶Ğ¸Ğ·Ğ½Ğ¸ Ñ‡ĞµÑ€ĞµĞ· scope
 * - Ğ˜ÑĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ñ Ğ±ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ñ‹ - Ğ´ĞµÑÑ‚Ñ€ÑƒĞºÑ‚Ğ¾Ñ€ Ğ²Ñ‹Ğ·Ğ¾Ğ²ĞµÑ‚ÑÑ Ğ¿Ñ€Ğ¸ Ñ€Ğ°ÑĞºÑ€ÑƒÑ‚ĞºĞµ ÑÑ‚ĞµĞºĞ°
 * 
 * ĞŸĞ Ğ˜ĞœĞ•Ğ Ğ« RAII Ğ’ STL:
 * - std::unique_ptr, std::shared_ptr - ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ¿Ğ°Ğ¼ÑÑ‚ÑŒÑ
 * - std::lock_guard, std::unique_lock - ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ¼ÑŒÑÑ‚ĞµĞºÑĞ°Ğ¼Ğ¸
 * - std::fstream - ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ñ„Ğ°Ğ¹Ğ»Ğ°Ğ¼Ğ¸
 * - std::vector, std::string - ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ±ÑƒÑ„ĞµÑ€Ğ°Ğ¼Ğ¸
 */

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// âŒ Ğ‘Ğ•Ğ— RAII - Ğ¿Ñ€Ğ¾Ğ±Ğ»ĞµĞ¼Ñ‹ Ñ Ñ€ĞµÑÑƒÑ€ÑĞ°Ğ¼Ğ¸
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

void bad_resource_management() {
    int* data = new int[100];
    
    // Ğ•ÑĞ»Ğ¸ Ğ·Ğ´ĞµÑÑŒ Ğ¿Ñ€Ğ¾Ğ¸Ğ·Ğ¾Ğ¹Ğ´ĞµÑ‚ Ğ¸ÑĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ â†’ ÑƒÑ‚ĞµÑ‡ĞºĞ° Ğ¿Ğ°Ğ¼ÑÑ‚Ğ¸!
    // process_data(data);
    
    delete[] data;  // ĞœĞ¾Ğ¶ĞµÑ‚ Ğ½Ğµ Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½Ğ¸Ñ‚ÑŒÑÑ
}

void bad_file_handling() {
    FILE* file = fopen("data.txt", "r");
    
    if (!file) return;
    
    // Ğ•ÑĞ»Ğ¸ Ğ·Ğ´ĞµÑÑŒ Ğ¸ÑĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ â†’ Ñ„Ğ°Ğ¹Ğ» Ğ½Ğµ Ğ·Ğ°ĞºÑ€Ğ¾ĞµÑ‚ÑÑ!
    // read_data(file);
    
    fclose(file);  // ĞœĞ¾Ğ¶ĞµÑ‚ Ğ½Ğµ Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½Ğ¸Ñ‚ÑŒÑÑ
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// âœ… Ğ¡ RAII - Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¾Ğµ ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ñ€ĞµÑÑƒÑ€ÑĞ°Ğ¼Ğ¸
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

void good_resource_management() {
    auto data = std::make_unique<int[]>(100);
    
    // Ğ˜ÑĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ? ĞĞµÑ‚ Ğ¿Ñ€Ğ¾Ğ±Ğ»ĞµĞ¼!
    // Ğ”ĞµÑÑ‚Ñ€ÑƒĞºÑ‚Ğ¾Ñ€ unique_ptr Ğ¾ÑĞ²Ğ¾Ğ±Ğ¾Ğ´Ğ¸Ñ‚ Ğ¿Ğ°Ğ¼ÑÑ‚ÑŒ Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸
    // process_data(data.get());
    
}  // delete[] Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½Ğ¸Ñ‚ÑÑ Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸

void good_file_handling() {
    std::ifstream file("data.txt");
    
    if (!file) return;
    
    // Ğ˜ÑĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ? Ğ”ĞµÑÑ‚Ñ€ÑƒĞºÑ‚Ğ¾Ñ€ fstream Ğ·Ğ°ĞºÑ€Ğ¾ĞµÑ‚ Ñ„Ğ°Ğ¹Ğ»
    // std::string line;
    // std::getline(file, line);
    
}  // fclose() Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½Ğ¸Ñ‚ÑÑ Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// ĞšĞ°ÑÑ‚Ğ¾Ğ¼Ğ½Ñ‹Ğ¹ RAII wrapper Ğ´Ğ»Ñ FILE* (C API)
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

class FileHandle {
    FILE* file_;
    
public:
    explicit FileHandle(const char* filename, const char* mode)
        : file_(fopen(filename, mode)) {
        if (!file_) {
            throw std::runtime_error("Failed to open file");
        }
    }
    
    ~FileHandle() {
        if (file_) {
            fclose(file_);  // ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¾Ğµ Ğ·Ğ°ĞºÑ€Ñ‹Ñ‚Ğ¸Ğµ
        }
    }
    
    // Ğ—Ğ°Ğ¿Ñ€ĞµÑ‰Ğ°ĞµĞ¼ ĞºĞ¾Ğ¿Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ (Ñ€ĞµÑÑƒÑ€Ñ ÑƒĞ½Ğ¸ĞºĞ°Ğ»ĞµĞ½)
    FileHandle(const FileHandle&) = delete;
    FileHandle& operator=(const FileHandle&) = delete;
    
    // Ğ Ğ°Ğ·Ñ€ĞµÑˆĞ°ĞµĞ¼ Ğ¿ĞµÑ€ĞµĞ¼ĞµÑ‰ĞµĞ½Ğ¸Ğµ (Ğ¿ĞµÑ€ĞµĞ´Ğ°Ñ‡Ğ° Ğ²Ğ»Ğ°Ğ´ĞµĞ½Ğ¸Ñ)
    FileHandle(FileHandle&& other) noexcept
        : file_(std::exchange(other.file_, nullptr)) {}
    
    FILE* get() const { return file_; }
};

// Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ:
{
    FileHandle file("data.txt", "w");
    fprintf(file.get(), "Hello, RAII!\n");
    
    // Ğ•ÑĞ»Ğ¸ Ğ·Ğ´ĞµÑÑŒ Ğ¸ÑĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ â†’ Ğ´ĞµÑÑ‚Ñ€ÑƒĞºÑ‚Ğ¾Ñ€ FileHandle Ğ·Ğ°ĞºÑ€Ğ¾ĞµÑ‚ Ñ„Ğ°Ğ¹Ğ»
}  // Ğ¤Ğ°Ğ¹Ğ» Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸ Ğ·Ğ°ĞºÑ€Ğ¾ĞµÑ‚ÑÑ

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// Scope Guard - Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½Ğ¸Ñ‚ÑŒ ĞºĞ¾Ğ´ Ğ¿Ñ€Ğ¸ Ğ²Ñ‹Ñ…Ğ¾Ğ´Ğµ Ğ¸Ğ· scope
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

template<typename F>
class ScopeGuard {
    F cleanup_;
    bool active_;
    
public:
    explicit ScopeGuard(F cleanup)
        : cleanup_(std::move(cleanup)), active_(true) {}
    
    ~ScopeGuard() {
        if (active_) {
            cleanup_();  // Ğ’Ñ‹Ğ¿Ğ¾Ğ»Ğ½Ğ¸Ñ‚ÑŒ cleanup Ğ¿Ñ€Ğ¸ ÑƒĞ½Ğ¸Ñ‡Ñ‚Ğ¾Ğ¶ĞµĞ½Ğ¸Ğ¸
        }
    }
    
    void dismiss() { active_ = false; }  // ĞÑ‚Ğ¼ĞµĞ½Ğ¸Ñ‚ÑŒ cleanup
    
    ScopeGuard(const ScopeGuard&) = delete;
    ScopeGuard& operator=(const ScopeGuard&) = delete;
};

// Helper Ğ´Ğ»Ñ ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ñ scope guard
template<typename F>
ScopeGuard<F> make_scope_guard(F cleanup) {
    return ScopeGuard<F>(std::move(cleanup));
}

// ĞŸÑ€Ğ¸Ğ¼ĞµÑ€ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ:
bool cleanup_called = false;

{
    auto guard = make_scope_guard([&cleanup_called]() {
        std::cout << "Cleanup executed\n";
        cleanup_called = true;
    });
    
    std::cout << "Doing work...\n";
    
    // Ğ›ÑĞ±Ğ¾Ğµ Ğ¸ÑĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ â†’ cleanup Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½Ğ¸Ñ‚ÑÑ
    // throw std::runtime_error("Error");
    
}  // Ğ”ĞµÑÑ‚Ñ€ÑƒĞºÑ‚Ğ¾Ñ€ guard â†’ cleanup Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½Ğ¸Ñ‚ÑÑ

std::cout << "Cleanup called: " << std::boolalpha << cleanup_called << '\n';

// Ğ¡ Ğ¾Ñ‚Ğ¼ĞµĞ½Ğ¾Ğ¹ cleanup (ĞµÑĞ»Ğ¸ Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸Ñ ÑƒÑĞ¿ĞµÑˆĞ½Ğ°):
{
    auto guard = make_scope_guard([]() {
        std::cout << "Rollback\n";
    });
    
    // ĞĞ¿ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸...
    
    // Ğ•ÑĞ»Ğ¸ Ğ²ÑÑ‘ OK - Ğ¾Ñ‚Ğ¼ĞµĞ½ÑĞµĞ¼ cleanup
    guard.dismiss();
}  // Cleanup ĞĞ• Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½Ğ¸Ñ‚ÑÑ

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// RAII Ğ´Ğ»Ñ Ñ‚Ñ€Ğ°Ğ½Ğ·Ğ°ĞºÑ†Ğ¸Ğ¹ (Database Transaction Pattern)
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

class Transaction {
    bool committed_ = false;
    
    void rollback() {
        std::cout << "Rolling back transaction\n";
        // ĞÑ‚ĞºĞ°Ñ‚ Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ğ¹ Ğ² Ğ‘Ğ”
    }
    
public:
    void commit() {
        std::cout << "Committing transaction\n";
        committed_ = true;
        // Ğ¤Ğ¸ĞºÑĞ°Ñ†Ğ¸Ñ Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ğ¹ Ğ² Ğ‘Ğ”
    }
    
    ~Transaction() {
        if (!committed_) {
            rollback();  // ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ rollback ĞµÑĞ»Ğ¸ Ğ½Ğµ Ğ±Ñ‹Ğ»Ğ¾ commit
        }
    }
};

// Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ:
try {
    Transaction txn;
    
    std::cout << "Executing SQL queries...\n";
    // db.execute("INSERT ...");
    // db.execute("UPDATE ...");
    
    // Ğ•ÑĞ»Ğ¸ Ğ·Ğ´ĞµÑÑŒ Ğ¸ÑĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ â†’ Ğ´ĞµÑÑ‚Ñ€ÑƒĞºÑ‚Ğ¾Ñ€ Ğ²Ñ‹Ğ·Ğ¾Ğ²ĞµÑ‚ rollback
    // throw std::runtime_error("DB error");
    
    txn.commit();  // Ğ¯Ğ²Ğ½Ğ°Ñ Ñ„Ğ¸ĞºÑĞ°Ñ†Ğ¸Ñ
    
} catch (const std::exception& e) {
    std::cout << "Error: " << e.what() << '\n';
    // Ğ”ĞµÑÑ‚Ñ€ÑƒĞºÑ‚Ğ¾Ñ€ Transaction Ğ²Ñ‹Ğ·Ğ¾Ğ²ĞµÑ‚ rollback Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// RAII Ğ´Ğ»Ñ Ğ¼ÑŒÑÑ‚ĞµĞºÑĞ¾Ğ²
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

std::mutex mtx;
std::vector<int> shared_data;

// âŒ Ğ‘Ğ•Ğ— RAII
void unsafe_access() {
    mtx.lock();
    
    shared_data.push_back(42);
    
    // Ğ•ÑĞ»Ğ¸ Ğ·Ğ´ĞµÑÑŒ Ğ¸ÑĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ â†’ Ğ¼ÑŒÑÑ‚ĞµĞºÑ Ğ¾ÑÑ‚Ğ°Ğ½ĞµÑ‚ÑÑ Ğ·Ğ°Ğ»Ğ¾Ñ‡ĞµĞ½Ğ½Ñ‹Ğ¼!
    // Deadlock!
    
    mtx.unlock();  // ĞœĞ¾Ğ¶ĞµÑ‚ Ğ½Ğµ Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½Ğ¸Ñ‚ÑŒÑÑ
}

// âœ… Ğ¡ RAII (std::lock_guard)
void safe_access() {
    std::lock_guard<std::mutex> lock(mtx);  // ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ lock
    
    shared_data.push_back(42);
    
    // Ğ›ÑĞ±Ğ¾Ğµ Ğ¸ÑĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ â†’ Ğ´ĞµÑÑ‚Ñ€ÑƒĞºÑ‚Ğ¾Ñ€ lock_guard Ñ€Ğ°Ğ·Ğ±Ğ»Ğ¾ĞºĞ¸Ñ€ÑƒĞµÑ‚ Ğ¼ÑŒÑÑ‚ĞµĞºÑ
    
}  // ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ unlock

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// RAII Ğ´Ğ»Ñ Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ½Ğ¾Ğ³Ğ¾ Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ñ ÑĞ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ñ
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

class StateGuard {
    bool& flag_;
    bool old_value_;
    
public:
    explicit StateGuard(bool& flag, bool new_value)
        : flag_(flag), old_value_(flag) {
        flag_ = new_value;  // Ğ˜Ğ·Ğ¼ĞµĞ½Ğ¸Ñ‚ÑŒ ÑĞ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ğµ
    }
    
    ~StateGuard() {
        flag_ = old_value_;  // Ğ’Ğ¾ÑÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ ÑÑ‚Ğ°Ñ€Ğ¾Ğµ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ
    }
};

// Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ:
bool global_flag = false;

{
    StateGuard guard(global_flag, true);  // Ğ’Ñ€ĞµĞ¼ĞµĞ½Ğ½Ğ¾ ÑƒÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ¸Ğ»Ğ¸ true
    
    std::cout << "Flag is: " << global_flag << '\n';  // true
    
    // ĞĞ¿ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸ Ğ¿Ñ€Ğ¸ Ğ²ĞºĞ»ÑÑ‡ĞµĞ½Ğ½Ğ¾Ğ¼ Ñ„Ğ»Ğ°Ğ³Ğµ...
    
}  // Ğ”ĞµÑÑ‚Ñ€ÑƒĞºÑ‚Ğ¾Ñ€ StateGuard Ğ²Ğ¾ÑÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ¸Ñ‚ false

std::cout << "Flag is: " << global_flag << '\n';  // false


// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ğŸ“Œ std::optional<T> (C++17) - ĞĞŸĞ¦Ğ˜ĞĞĞĞ›Ğ¬ĞĞĞ• Ğ—ĞĞĞ§Ğ•ĞĞ˜Ğ•
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

/*
 * std::optional<T> - ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€, ĞºĞ¾Ñ‚Ğ¾Ñ€Ñ‹Ğ¹ Ğ¼Ğ¾Ğ¶ĞµÑ‚ ÑĞ¾Ğ´ĞµÑ€Ğ¶Ğ°Ñ‚ÑŒ Ğ¸Ğ»Ğ¸ Ğ½Ğµ ÑĞ¾Ğ´ĞµÑ€Ğ¶Ğ°Ñ‚ÑŒ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ
 * 
 * Ğ˜Ğ¡ĞŸĞĞ›Ğ¬Ğ—Ğ£Ğ™Ğ¢Ğ• ĞšĞĞ“Ğ”Ğ:
 * - Ğ¤ÑƒĞ½ĞºÑ†Ğ¸Ñ Ğ¼Ğ¾Ğ¶ĞµÑ‚ Ğ½Ğµ Ğ²ĞµÑ€Ğ½ÑƒÑ‚ÑŒ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ (Ğ½Ğ¾ ÑÑ‚Ğ¾ Ğ½Ğµ Ğ¾ÑˆĞ¸Ğ±ĞºĞ°)
 * - Nullable Ñ‚Ğ¸Ğ¿Ñ‹ (Ğ·Ğ°Ğ¼ĞµĞ½Ğ° ÑƒĞºĞ°Ğ·Ğ°Ñ‚ĞµĞ»ĞµĞ¹)
 * - ĞĞ¿Ñ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ñ‹Ğµ Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ñ‹
 * 
 * ĞŸĞ Ğ•Ğ˜ĞœĞ£Ğ©Ğ•Ğ¡Ğ¢Ğ’Ğ ĞĞĞ” Ğ£ĞšĞĞ—ĞĞ¢Ğ•Ğ›Ğ¯ĞœĞ˜:
 * - Ğ’Ğ»Ğ°Ğ´ĞµĞ½Ğ¸Ğµ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸ĞµĞ¼ (value semantics)
 * - Ğ¯Ğ²Ğ½Ğ°Ñ ÑĞµĞ¼Ğ°Ğ½Ñ‚Ğ¸ĞºĞ° "ĞµÑÑ‚ÑŒ/Ğ½ĞµÑ‚ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ñ"
 * - Ğ£Ğ´Ğ¾Ğ±Ğ½Ñ‹Ğ¹ Ğ¸Ğ½Ñ‚ĞµÑ€Ñ„ĞµĞ¹Ñ (has_value, value_or)
 * - Ğ‘ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½ĞµĞµ (Ğ½ĞµÑ‚ nullptr dereferencing)
 */

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ¸ Ğ±Ğ°Ğ·Ğ¾Ğ²Ğ¾Ğµ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

std::optional<int> parse_int(const std::string& str) {
    try {
        return std::stoi(str);  // ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ°Ñ ÑƒĞ¿Ğ°ĞºĞ¾Ğ²ĞºĞ° Ğ² optional
    } catch (...) {
        return std::nullopt;  // ĞĞµÑ‚ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ñ
    }
}

std::optional<std::string> find_user(int id) {
    if (id == 42) {
        return "Alice";
    }
    return std::nullopt;  // ĞŸĞ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ÑŒ Ğ½Ğµ Ğ½Ğ°Ğ¹Ğ´ĞµĞ½
}

// ĞŸÑ€Ğ¸Ğ¼ĞµÑ€ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ:
auto result = parse_int("123");

// Ğ¡Ğ¿Ğ¾ÑĞ¾Ğ± 1: has_value()
if (result.has_value()) {
    std::cout << "Parsed: " << result.value() << '\n';
}

// Ğ¡Ğ¿Ğ¾ÑĞ¾Ğ± 2: operator bool
if (result) {
    std::cout << "Has value: " << *result << '\n';  // ĞĞ¿ĞµÑ€Ğ°Ñ‚Ğ¾Ñ€ *
}

// Ğ¡Ğ¿Ğ¾ÑĞ¾Ğ± 3: value_or - Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ Ğ¸Ğ»Ğ¸ Ğ´ĞµÑ„Ğ¾Ğ»Ñ‚
auto bad = parse_int("not a number");
std::cout << "Value or default: " << bad.value_or(-1) << '\n';  // -1

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// ĞšĞ¾Ğ½ÑÑ‚Ñ€ÑƒĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ optional
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

std::optional<int> empty1;               // ĞŸÑƒÑÑ‚Ğ¾Ğ¹ optional
std::optional<int> empty2 = std::nullopt;  // Ğ¯Ğ²Ğ½Ğ¾ Ğ¿ÑƒÑÑ‚Ğ¾Ğ¹
std::optional<int> with_value = 42;      // Ğ¡ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸ĞµĞ¼
std::optional<int> from_value{42};       // Ğ§ĞµÑ€ĞµĞ· {}

// In-place ĞºĞ¾Ğ½ÑÑ‚Ñ€ÑƒĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ
struct Point {
    int x, y;
    Point(int x, int y) : x(x), y(y) {}
};

std::optional<Point> point1 = Point{10, 20};  // ĞšĞ¾Ğ¿Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ
std::optional<Point> point2(std::in_place, 10, 20);  // In-place (ÑÑ„Ñ„ĞµĞºÑ‚Ğ¸Ğ²Ğ½ĞµĞµ)

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ¸ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿ Ğº Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ñ
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

std::optional<std::string> maybe_name = find_user(42);

// âœ… Ğ‘ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ñ‹Ğ¹ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿
if (maybe_name) {
    std::cout << "Name: " << *maybe_name << '\n';
}

// âœ… Ğ¡ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ¾Ğ¹
if (maybe_name.has_value()) {
    std::cout << "Name: " << maybe_name.value() << '\n';
}

// âœ… Ğ¡ Ğ´ĞµÑ„Ğ¾Ğ»Ñ‚Ğ½Ñ‹Ğ¼ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸ĞµĞ¼
std::string name = maybe_name.value_or("Unknown");

// âŒ ĞĞŸĞĞ¡ĞĞ! value() Ğ±Ñ€Ğ¾ÑĞ°ĞµÑ‚ std::bad_optional_access ĞµÑĞ»Ğ¸ Ğ¿ÑƒÑÑ‚Ğ¾
try {
    std::optional<int> empty;
    int val = empty.value();  // Ğ‘Ñ€Ğ¾ÑĞ¸Ñ‚ Ğ¸ÑĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ!
} catch (const std::bad_optional_access& e) {
    std::cout << "Error: " << e.what() << '\n';
}

// âŒ ĞĞŸĞĞ¡ĞĞ! operator* Ğ½Ğµ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ÑĞµÑ‚ Ğ½Ğ°Ğ»Ğ¸Ñ‡Ğ¸Ğµ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ñ (UB ĞµÑĞ»Ğ¸ Ğ¿ÑƒÑÑ‚Ğ¾)
std::optional<int> empty;
// int val = *empty;  // Undefined Behavior!

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// ĞœĞ¾Ğ´Ğ¸Ñ„Ğ¸ĞºĞ°Ñ†Ğ¸Ñ optional
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

std::optional<int> num;

// Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ° Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ñ
num = 42;
num.emplace(100);  // In-place ĞºĞ¾Ğ½ÑÑ‚Ñ€ÑƒĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ (ÑÑ„Ñ„ĞµĞºÑ‚Ğ¸Ğ²Ğ½ĞµĞµ)

// Ğ¡Ğ±Ñ€Ğ¾Ñ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ñ
num.reset();  // Ğ¢ĞµĞ¿ĞµÑ€ÑŒ Ğ¿ÑƒÑÑ‚Ğ¾
num = std::nullopt;  // Ğ¢Ğ°ĞºĞ¶Ğµ Ğ´ĞµĞ»Ğ°ĞµÑ‚ Ğ¿ÑƒÑÑ‚Ñ‹Ğ¼

// ĞĞ±Ğ¼ĞµĞ½ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸ÑĞ¼Ğ¸
std::optional<int> a = 10, b = 20;
a.swap(b);  // a == 20, b == 10

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// C++23 Monadic Operations (ĞµÑĞ»Ğ¸ Ğ´Ğ¾ÑÑ‚ÑƒĞ¿Ğ½Ñ‹)
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

#if __cpp_lib_optional >= 202110L

auto user = find_user(42);

// and_then - Ğ¿Ñ€Ğ¸Ğ¼ĞµĞ½Ğ¸Ñ‚ÑŒ Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ñ ĞµÑĞ»Ğ¸ ĞµÑÑ‚ÑŒ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ
auto length = user.and_then([](const std::string& name) -> std::optional<size_t> {
    return name.length();
});

// transform - Ğ¿Ñ€ĞµĞ¾Ğ±Ñ€Ğ°Ğ·Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ
auto upper = user.transform([](const std::string& name) {
    std::string result = name;
    for (auto& c : result) c = std::toupper(c);
    return result;
});

if (upper) {
    std::cout << "Uppercase: " << *upper << '\n';
}

// or_else - Ğ°Ğ»ÑŒÑ‚ĞµÑ€Ğ½Ğ°Ñ‚Ğ¸Ğ²Ğ° ĞµÑĞ»Ğ¸ Ğ¿ÑƒÑÑ‚Ğ¾
auto result = find_user(999)
    .or_else([]() -> std::optional<std::string> {
        return "Default User";
    });

// Ğ¦ĞµĞ¿Ğ¾Ñ‡ĞºĞ° Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸Ğ¹ (functional style)
auto final_result = find_user(42)
    .and_then([](const std::string& name) -> std::optional<int> {
        return name.length();
    })
    .and_then([](int len) -> std::optional<int> {
        return len > 3 ? std::optional<int>(len * 2) : std::nullopt;
    })
    .value_or(0);

#endif

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// Ğ¡Ñ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ğµ optional
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

std::optional<int> a = 10;
std::optional<int> b = 20;
std::optional<int> empty;

bool eq = (a == b);           // false
bool lt = (a < b);            // true
bool empty_eq = (empty == std::nullopt);  // true

// Ğ¡Ñ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ğµ Ñ Ğ¾Ğ±Ñ‹Ñ‡Ğ½Ñ‹Ğ¼ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸ĞµĞ¼
bool cmp = (a == 10);  // true
bool cmp2 = (empty == 10);  // false

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// ĞŸÑ€Ğ¸Ğ¼ĞµÑ€Ñ‹ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ optional
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// ĞŸÑ€Ğ¸Ğ¼ĞµÑ€ 1: ĞŸĞ¾Ğ¸ÑĞº ÑĞ»ĞµĞ¼ĞµĞ½Ñ‚Ğ°
std::optional<size_t> find_index(const std::vector<int>& vec, int value) {
    for (size_t i = 0; i < vec.size(); ++i) {
        if (vec[i] == value) {
            return i;
        }
    }
    return std::nullopt;  // ĞĞµ Ğ½Ğ°Ğ¹Ğ´ĞµĞ½
}

// Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ:
std::vector<int> numbers = {10, 20, 30};
if (auto idx = find_index(numbers, 20)) {
    std::cout << "Found at index: " << *idx << '\n';
} else {
    std::cout << "Not found\n";
}

// ĞŸÑ€Ğ¸Ğ¼ĞµÑ€ 2: ĞšĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ñ Ñ Ğ¾Ğ¿Ñ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¼Ğ¸ Ğ¿Ğ¾Ğ»ÑĞ¼Ğ¸
struct Config {
    std::optional<int> port;          // ĞœĞ¾Ğ¶ĞµÑ‚ Ğ±Ñ‹Ñ‚ÑŒ Ğ½Ğµ ÑƒĞºĞ°Ğ·Ğ°Ğ½
    std::optional<std::string> host;  // ĞœĞ¾Ğ¶ĞµÑ‚ Ğ±Ñ‹Ñ‚ÑŒ Ğ½Ğµ ÑƒĞºĞ°Ğ·Ğ°Ğ½
    int timeout = 30;                 // ĞĞ±ÑĞ·Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ñ‹Ğ¹ Ñ Ğ´ĞµÑ„Ğ¾Ğ»Ñ‚Ğ¾Ğ¼
};

Config cfg;
cfg.port = 8080;
// cfg.host Ğ½Ğµ ÑƒÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ»ĞµĞ½

std::string host = cfg.host.value_or("localhost");
int port = cfg.port.value_or(80);

// ĞŸÑ€Ğ¸Ğ¼ĞµÑ€ 3: Ğ’Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‚ Ğ¾Ğ¿Ñ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾Ğ³Ğ¾ Ñ€ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚Ğ°
std::optional<double> safe_divide(double a, double b) {
    if (b == 0.0) {
        return std::nullopt;  // Ğ”ĞµĞ»ĞµĞ½Ğ¸Ğµ Ğ½Ğ° Ğ½Ğ¾Ğ»ÑŒ
    }
    return a / b;
}

// Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ:
auto result = safe_divide(10.0, 2.0);
if (result) {
    std::cout << "Result: " << *result << '\n';
} else {
    std::cout << "Division by zero\n";
}


// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ğŸ“Œ std::expected<T, E> (C++23) - Ğ Ğ•Ğ—Ğ£Ğ›Ğ¬Ğ¢ĞĞ¢ Ğ˜Ğ›Ğ˜ ĞĞ¨Ğ˜Ğ‘ĞšĞ
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

/*
 * std::expected<T, E> - ÑĞ¾Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ½Ğ°Ñ Ğ°Ğ»ÑŒÑ‚ĞµÑ€Ğ½Ğ°Ñ‚Ğ¸Ğ²Ğ° Ğ¸ÑĞºĞ»ÑÑ‡ĞµĞ½Ğ¸ÑĞ¼
 * 
 * Ğ¡ĞĞ”Ğ•Ğ Ğ–Ğ˜Ğ¢ Ğ›Ğ˜Ğ‘Ğ:
 * - Ğ—Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ Ñ‚Ğ¸Ğ¿Ğ° T (ÑƒÑĞ¿ĞµÑ…)
 * - ĞÑˆĞ¸Ğ±ĞºÑƒ Ñ‚Ğ¸Ğ¿Ğ° E (Ğ½ĞµÑƒĞ´Ğ°Ñ‡Ğ°)
 * 
 * Ğ˜Ğ¡ĞŸĞĞ›Ğ¬Ğ—Ğ£Ğ™Ğ¢Ğ• ĞšĞĞ“Ğ”Ğ:
 * - ĞÑˆĞ¸Ğ±ĞºĞ¸ - Ñ‡Ğ°ÑÑ‚ÑŒ Ğ½Ğ¾Ñ€Ğ¼Ğ°Ğ»ÑŒĞ½Ğ¾Ğ³Ğ¾ control flow
 * - ĞÑƒĞ¶Ğ½Ğ° Ğ¿Ñ€ĞµĞ´ÑĞºĞ°Ğ·ÑƒĞµĞ¼Ğ°Ñ Ğ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ
 * - Ğ¤ÑƒĞ½ĞºÑ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ ÑÑ‚Ğ¸Ğ»ÑŒ Ğ¿Ñ€Ğ¾Ğ³Ñ€Ğ°Ğ¼Ğ¼Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ
 * - Ğ¯Ğ²Ğ½Ğ°Ñ Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ° Ğ¾ÑˆĞ¸Ğ±Ğ¾Ğº
 * 
 * ĞŸĞ Ğ•Ğ˜ĞœĞ£Ğ©Ğ•Ğ¡Ğ¢Ğ’Ğ:
 * - ĞĞµÑ‚ overhead Ğ¸ÑĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğ¹
 * - Ğ¯Ğ²Ğ½Ğ°Ñ ÑĞ¸Ğ³Ğ½Ğ°Ñ‚ÑƒÑ€Ğ° (Ğ²Ğ¸Ğ´Ğ½Ğ¾ Ñ‡Ñ‚Ğ¾ Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ñ Ğ¼Ğ¾Ğ¶ĞµÑ‚ Ğ²ĞµÑ€Ğ½ÑƒÑ‚ÑŒ Ğ¾ÑˆĞ¸Ğ±ĞºÑƒ)
 * - ĞšĞ¾Ğ¼Ğ¿Ğ¾Ğ·Ğ¸Ñ†Ğ¸Ñ Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸Ğ¹ (monadic operations)
 * - Type-safe Ğ¾ÑˆĞ¸Ğ±ĞºĞ¸
 */

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// ĞĞ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ¸Ğµ Ñ‚Ğ¸Ğ¿Ğ¾Ğ² Ğ¾ÑˆĞ¸Ğ±Ğ¾Ğº
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

enum class ParseError {
    InvalidFormat,
    OutOfRange,
    Empty
};

// Helper Ğ´Ğ»Ñ Ğ¿Ñ€ĞµĞ¾Ğ±Ñ€Ğ°Ğ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ Ğ¾ÑˆĞ¸Ğ±ĞºĞ¸ Ğ² ÑÑ‚Ñ€Ğ¾ĞºÑƒ
std::string to_string(ParseError err) {
    switch (err) {
        case ParseError::InvalidFormat: return "Invalid format";
        case ParseError::OutOfRange: return "Out of range";
        case ParseError::Empty: return "Empty string";
    }
    return "Unknown";
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ¸ Ğ²Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‚ expected
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

std::expected<int, ParseError> parse_number(const std::string& str) {
    if (str.empty()) {
        return std::unexpected(ParseError::Empty);  // Ğ’Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‚ Ğ¾ÑˆĞ¸Ğ±ĞºĞ¸
    }
    
    try {
        int value = std::stoi(str);
        if (value < 0 || value > 100) {
            return std::unexpected(ParseError::OutOfRange);
        }
        return value;  // Ğ’Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‚ ÑƒÑĞ¿ĞµÑ…Ğ° (Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ°Ñ ÑƒĞ¿Ğ°ĞºĞ¾Ğ²ĞºĞ°)
    } catch (...) {
        return std::unexpected(ParseError::InvalidFormat);
    }
}

// ĞŸÑ€Ğ¸Ğ¼ĞµÑ€ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ:
auto result = parse_number("42");

// ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° ÑƒÑĞ¿ĞµÑ…Ğ°/Ğ½ĞµÑƒĞ´Ğ°Ñ‡Ğ¸
if (result) {  // operator bool
    std::cout << "Success: " << *result << '\n';  // Ğ”Ğ¾ÑÑ‚ÑƒĞ¿ Ğº Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ñ
} else {
    std::cout << "Error: " << to_string(result.error()) << '\n';
}

// ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ñ‡ĞµÑ€ĞµĞ· has_value()
if (result.has_value()) {
    std::cout << "Value: " << result.value() << '\n';
}

// ĞŸĞ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğµ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ñ Ğ¸Ğ»Ğ¸ Ğ´ĞµÑ„Ğ¾Ğ»Ñ‚Ğ°
auto bad = parse_number("999");
int safe_value = bad.value_or(0);  // 0 ĞµÑĞ»Ğ¸ Ğ¾ÑˆĞ¸Ğ±ĞºĞ°

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// Monadic operations (C++23) - ĞºĞ¾Ğ¼Ğ¿Ğ¾Ğ·Ğ¸Ñ†Ğ¸Ñ Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸Ğ¹
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

#if __cpp_lib_expected >= 202202L

std::expected<int, ParseError> double_value(int x) {
    return x * 2;
}

std::expected<std::string, ParseError> to_string_safe(int x) {
    return std::to_string(x);
}

// and_then - Ñ†ĞµĞ¿Ğ¾Ñ‡ĞºĞ° Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸Ğ¹ (Ğ¾ÑÑ‚Ğ°Ğ½Ğ°Ğ²Ğ»Ğ¸Ğ²Ğ°ĞµÑ‚ÑÑ Ğ¿Ñ€Ğ¸ Ğ¿ĞµÑ€Ğ²Ğ¾Ğ¹ Ğ¾ÑˆĞ¸Ğ±ĞºĞµ)
auto result_chain = parse_number("10")
    .and_then(double_value)          // Ğ¢Ğ¾Ğ»ÑŒĞºĞ¾ ĞµÑĞ»Ğ¸ Ğ¿Ñ€ĞµĞ´Ñ‹Ğ´ÑƒÑ‰ĞµĞµ ÑƒÑĞ¿ĞµÑˆĞ½Ğ¾
    .and_then(to_string_safe);       // Ğ¢Ğ¾Ğ»ÑŒĞºĞ¾ ĞµÑĞ»Ğ¸ Ğ¿Ñ€ĞµĞ´Ñ‹Ğ´ÑƒÑ‰ĞµĞµ ÑƒÑĞ¿ĞµÑˆĞ½Ğ¾

if (result_chain) {
    std::cout << "Result: " << *result_chain << '\n';  // "20"
}

// transform - Ğ¿Ñ€ĞµĞ¾Ğ±Ñ€Ğ°Ğ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ñ (Ğ½Ğµ Ğ¼ĞµĞ½ÑĞµÑ‚ Ñ‚Ğ¸Ğ¿ Ğ¾ÑˆĞ¸Ğ±ĞºĞ¸)
auto transformed = parse_number("42")
    .transform([](int x) { return x * 3; });

if (transformed) {
    std::cout << "Transformed: " << *transformed << '\n';  // 126
}

// or_else - Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ° Ğ¾ÑˆĞ¸Ğ±ĞºĞ¸
auto with_recovery = parse_number("invalid")
    .or_else([](ParseError err) -> std::expected<int, ParseError> {
        std::cout << "Recovering from: " << to_string(err) << '\n';
        return 0;  // Ğ”ĞµÑ„Ğ¾Ğ»Ñ‚Ğ½Ğ¾Ğµ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ Ğ¿Ñ€Ğ¸ Ğ¾ÑˆĞ¸Ğ±ĞºĞµ
    });

// Ğ¡Ğ»Ğ¾Ğ¶Ğ½Ğ°Ñ Ñ†ĞµĞ¿Ğ¾Ñ‡ĞºĞ° Ñ Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ¾Ğ¹ Ğ¾ÑˆĞ¸Ğ±Ğ¾Ğº
auto complex = parse_number("15")
    .and_then([](int x) -> std::expected<int, ParseError> {
        if (x % 2 == 0) return x / 2;
        return std::unexpected(ParseError::InvalidFormat);
    })
    .or_else([](ParseError) -> std::expected<int, ParseError> {
        return 99;  // Ğ”ĞµÑ„Ğ¾Ğ»Ñ‚ Ğ¿Ñ€Ğ¸ Ğ¾ÑˆĞ¸Ğ±ĞºĞµ
    });

#endif

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// Ğ¡Ñ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ğµ Ñ Ğ¸ÑĞºĞ»ÑÑ‡ĞµĞ½Ğ¸ÑĞ¼Ğ¸
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// âŒ Ğ¡ Ğ˜Ğ¡ĞšĞ›Ğ®Ğ§Ğ•ĞĞ˜Ğ¯ĞœĞ˜ - Ğ¼Ğ¾Ğ¶ĞµÑ‚ Ğ±Ñ‹Ñ‚ÑŒ Ğ¼ĞµĞ´Ğ»ĞµĞ½Ğ½ĞµĞµ Ğ¿Ñ€Ğ¸ Ğ¾ÑˆĞ¸Ğ±ĞºĞ°Ñ…
int parse_with_exception(const std::string& str) {
    return std::stoi(str);  // Ğ‘Ñ€Ğ¾ÑĞ°ĞµÑ‚ std::invalid_argument
}

// Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ:
try {
    int val = parse_with_exception("abc");
    std::cout << "Value: " << val << '\n';
} catch (const std::exception& e) {
    std::cout << "Exception: " << e.what() << '\n';  // "invalid stoi argument"
}

// âœ… Ğ¡ EXPECTED - Ğ¿Ñ€ĞµĞ´ÑĞºĞ°Ğ·ÑƒĞµĞ¼Ğ°Ñ Ğ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ
std::expected<int, std::string> parse_with_expected(const std::string& str) {
    try {
        return std::stoi(str);
    } catch (const std::exception& e) {
        return std::unexpected(std::string(e.what()));
    }
}

// Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ:
auto result_exp = parse_with_expected("abc");
if (!result_exp) {
    std::cout << "Error: " << result_exp.error() << '\n';
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// ĞŸÑ€Ğ¸Ğ¼ĞµÑ€Ñ‹ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ expected
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// ĞŸÑ€Ğ¸Ğ¼ĞµÑ€ 1: Ğ§Ñ‚ĞµĞ½Ğ¸Ğµ Ğ¸Ğ· Ñ„Ğ°Ğ¹Ğ»Ğ°
std::expected<std::string, std::string> read_file(const std::string& path) {
    std::ifstream file(path);
    if (!file) {
        return std::unexpected("Cannot open file: " + path);
    }
    
    std::string content((std::istreambuf_iterator<char>(file)),
                        std::istreambuf_iterator<char>());
    return content;
}

// Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ñ Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ¾Ğ¹:
auto content = read_file("data.txt")
    .or_else([](const std::string& err) -> std::expected<std::string, std::string> {
        std::cerr << "Error: " << err << '\n';
        return "";  // ĞŸÑƒÑÑ‚Ğ°Ñ ÑÑ‚Ñ€Ğ¾ĞºĞ° Ğ¿Ñ€Ğ¸ Ğ¾ÑˆĞ¸Ğ±ĞºĞµ
    });

// ĞŸÑ€Ğ¸Ğ¼ĞµÑ€ 2: Ğ”ĞµĞ»ĞµĞ½Ğ¸Ğµ Ñ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ĞºĞ¾Ğ¹
std::expected<double, std::string> safe_divide(double a, double b) {
    if (b == 0.0) {
        return std::unexpected("Division by zero");
    }
    return a / b;
}

auto div_result = safe_divide(10.0, 0.0);
if (!div_result) {
    std::cout << "Error: " << div_result.error() << '\n';
}

/*
 * â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
 * ĞšĞĞ“Ğ”Ğ Ğ˜Ğ¡ĞŸĞĞ›Ğ¬Ğ—ĞĞ’ĞĞ¢Ğ¬ Ğ§Ğ¢Ğ?
 * â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
 * 
 * EXCEPTIONS (std::exception):
 * âœ“ Ğ ĞµĞ´ĞºĞ¸Ğµ, Ğ¸ÑĞºĞ»ÑÑ‡Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ñ‹Ğµ ÑĞ¸Ñ‚ÑƒĞ°Ñ†Ğ¸Ğ¸
 * âœ“ Ğ“Ğ»ÑƒĞ±Ğ¾ĞºĞ¸Ğ¹ call stack (Ğ½ÑƒĞ¶Ğ½Ğ¾ Ğ¿Ñ€Ğ¾Ğ±Ñ€Ğ¾ÑĞ¸Ñ‚ÑŒ Ñ‡ĞµÑ€ĞµĞ· Ğ¼Ğ½Ğ¾Ğ³Ğ¾ ÑƒÑ€Ğ¾Ğ²Ğ½ĞµĞ¹)
 * âœ“ ĞÑƒĞ¶Ğ½Ğ¾ Ñ€ĞµĞ·ĞºĞ¾ Ğ¿Ñ€ĞµÑ€Ğ²Ğ°Ñ‚ÑŒ Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ĞµĞ½Ğ¸Ğµ
 * âœ“ ĞĞµÑ‚ ĞºĞ¾Ğ½Ñ‚Ñ€Ğ¾Ğ»Ñ Ğ½Ğ°Ğ´ Ñ‡Ğ°ÑÑ‚Ğ¾Ñ‚Ğ¾Ğ¹ Ğ¾ÑˆĞ¸Ğ±Ğ¾Ğº
 * âœ“ RAII cleanup ĞºÑ€Ğ¸Ñ‚Ğ¸Ñ‡ĞµĞ½
 * âœ— Overhead Ğ¿Ñ€Ğ¸ Ğ±Ñ€Ğ¾ÑĞ°Ğ½Ğ¸Ğ¸
 * âœ— ĞĞµÑĞ²Ğ½Ğ°Ñ Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ° (Ğ·Ğ°Ğ±Ñ‹Ğ»Ğ¸ catch â†’ std::terminate)
 * 
 * EXPECTED (std::expected<T, E>):
 * âœ“ Ğ§Ğ°ÑÑ‚Ñ‹Ğµ Ğ¾ÑˆĞ¸Ğ±ĞºĞ¸ (Ñ‡Ğ°ÑÑ‚ÑŒ Ğ½Ğ¾Ñ€Ğ¼Ğ°Ğ»ÑŒĞ½Ğ¾Ğ³Ğ¾ control flow)
 * âœ“ ĞŸÑ€ĞµĞ´ÑĞºĞ°Ğ·ÑƒĞµĞ¼Ğ°Ñ Ğ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ
 * âœ“ Ğ¤ÑƒĞ½ĞºÑ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ ÑÑ‚Ğ¸Ğ»ÑŒ Ñ Ğ¼Ğ¾Ğ½Ğ°Ğ´Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¼Ğ¸ Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸ÑĞ¼Ğ¸
 * âœ“ Ğ¯Ğ²Ğ½Ğ°Ñ Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ° Ğ¾ÑˆĞ¸Ğ±Ğ¾Ğº Ğ² ÑĞ¸Ğ³Ğ½Ğ°Ñ‚ÑƒÑ€Ğµ
 * âœ“ Type-safe ĞºĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ğ¸Ğ¸ Ğ¾ÑˆĞ¸Ğ±Ğ¾Ğº
 * âœ— ĞÑƒĞ¶Ğ½Ğ¾ ÑĞ²Ğ½Ğ¾ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ÑÑ‚ÑŒ Ğ¸ Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ°Ñ‚Ñ‹Ğ²Ğ°Ñ‚ÑŒ
 * âœ— Ğ‘Ğ¾Ğ»ÑŒÑˆĞµ boilerplate ĞºĞ¾Ğ´Ğ°
 * 
 * OPTIONAL (std::optional<T>):
 * âœ“ ĞÑ‚ÑÑƒÑ‚ÑÑ‚Ğ²Ğ¸Ğµ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ñ - Ğ½Ğ¾Ñ€Ğ¼Ğ°, Ğ½Ğµ Ğ¾ÑˆĞ¸Ğ±ĞºĞ°
 * âœ“ ĞĞµÑ‚ Ğ¿Ñ€Ğ¸Ñ‡Ğ¸Ğ½Ñ‹/Ñ‚Ğ¸Ğ¿Ğ° Ğ¾ÑˆĞ¸Ğ±ĞºĞ¸
 * âœ“ Nullable Ñ‚Ğ¸Ğ¿Ñ‹ (Ğ·Ğ°Ğ¼ĞµĞ½Ğ° nullptr)
 * âœ“ ĞĞ¿Ñ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ñ‹Ğµ Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€Ñ‹
 * 
 * ERROR CODES (std::error_code):
 * âœ“ Ğ˜Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ñ Ñ C API
 * âœ“ Ğ¡Ğ¸ÑÑ‚ĞµĞ¼Ğ½Ñ‹Ğµ Ğ¾ÑˆĞ¸Ğ±ĞºĞ¸ (errno, GetLastError)
 * âœ“ Ğ¡Ñ‚Ğ°Ğ½Ğ´Ğ°Ñ€Ñ‚Ğ¸Ğ·Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğµ ĞºĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ğ¸Ğ¸ Ğ¾ÑˆĞ¸Ğ±Ğ¾Ğº
 * âœ— ĞœĞµĞ½ĞµĞµ type-safe Ñ‡ĞµĞ¼ expected
 */


// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ğŸ“Œ ERROR CODES (ĞšĞĞ”Ğ« ĞĞ¨Ğ˜Ğ‘ĞĞš)
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

/*
 * std::error_code - ÑÑ‚Ğ°Ğ½Ğ´Ğ°Ñ€Ñ‚Ğ½Ñ‹Ğ¹ ÑĞ¿Ğ¾ÑĞ¾Ğ± Ğ¿Ñ€ĞµĞ´ÑÑ‚Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ñ ĞºĞ¾Ğ´Ğ¾Ğ² Ğ¾ÑˆĞ¸Ğ±Ğ¾Ğº
 * 
 * Ğ˜Ğ¡ĞŸĞĞ›Ğ¬Ğ—Ğ£Ğ™Ğ¢Ğ• ĞšĞĞ“Ğ”Ğ:
 * - Ğ˜Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ñ Ñ C API (errno, GetLastError)
 * - Ğ¡Ğ¸ÑÑ‚ĞµĞ¼Ğ½Ñ‹Ğµ Ğ¾ÑˆĞ¸Ğ±ĞºĞ¸ (Ñ„Ğ°Ğ¹Ğ»Ñ‹, ÑĞµÑ‚ÑŒ, OS)
 * - Ğ¡Ñ‚Ğ°Ğ½Ğ´Ğ°Ñ€Ñ‚Ğ¸Ğ·Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ½Ñ‹Ğµ ĞºĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ğ¸Ğ¸ Ğ¾ÑˆĞ¸Ğ±Ğ¾Ğº
 * - ĞÑƒĞ¶Ğ½Ğ° ÑĞ¾Ğ²Ğ¼ĞµÑÑ‚Ğ¸Ğ¼Ğ¾ÑÑ‚ÑŒ Ñ ÑÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒÑÑ‰Ğ¸Ğ¼Ğ¸ Ğ±Ğ¸Ğ±Ğ»Ğ¸Ğ¾Ñ‚ĞµĞºĞ°Ğ¼Ğ¸
 * 
 * ĞŸĞ Ğ•Ğ˜ĞœĞ£Ğ©Ğ•Ğ¡Ğ¢Ğ’Ğ:
 * - Ğ¡Ñ‚Ğ°Ğ½Ğ´Ğ°Ñ€Ñ‚Ğ½Ğ°Ñ Ğ¸Ğ½Ñ„Ñ€Ğ°ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ° (std::error_category)
 * - Ğ˜Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ñ Ñ <system_error>
 * - ĞœĞ¾Ğ¶ĞµÑ‚ Ğ±Ñ‹Ñ‚ÑŒ Ğ¿Ñ€ĞµĞ¾Ğ±Ñ€Ğ°Ğ·Ğ¾Ğ²Ğ°Ğ½ Ğ² std::exception Ñ‡ĞµÑ€ĞµĞ· std::system_error
 * - Ğ›ĞµĞ³ĞºĞ¾Ğ²ĞµÑĞ½Ñ‹Ğ¹ (int + ÑƒĞºĞ°Ğ·Ğ°Ñ‚ĞµĞ»ÑŒ Ğ½Ğ° ĞºĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ğ¸Ñ)
 */

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ ĞºĞ°ÑÑ‚Ğ¾Ğ¼Ğ½Ğ¾Ğ¹ ĞºĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ğ¸Ğ¸ Ğ¾ÑˆĞ¸Ğ±Ğ¾Ğº
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// 1. ĞĞ¿Ñ€ĞµĞ´ĞµĞ»ÑĞµĞ¼ enum Ñ ĞºĞ¾Ğ´Ğ°Ğ¼Ğ¸ Ğ¾ÑˆĞ¸Ğ±Ğ¾Ğº
enum class MyError {
    Success = 0,           // 0 = ÑƒÑĞ¿ĞµÑ… (Ğ¿Ğ¾ ĞºĞ¾Ğ½Ğ²ĞµĞ½Ñ†Ğ¸Ğ¸)
    FileNotFound,
    PermissionDenied,
    NetworkError
};

// 2. Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‘Ğ¼ ĞºĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ğ¸Ñ Ğ¾ÑˆĞ¸Ğ±Ğ¾Ğº (Ğ½Ğ°ÑĞ»ĞµĞ´ÑƒĞµĞ¼ Ğ¾Ñ‚ std::error_category)
class MyErrorCategory : public std::error_category {
public:
    // Ğ˜Ğ¼Ñ ĞºĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ğ¸Ğ¸ (ÑƒĞ½Ğ¸ĞºĞ°Ğ»ÑŒĞ½Ğ¾Ğµ)
    const char* name() const noexcept override {
        return "MyError";
    }
    
    // Ğ¢ĞµĞºÑÑ‚Ğ¾Ğ²Ğ¾Ğµ Ğ¾Ğ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ Ğ¾ÑˆĞ¸Ğ±ĞºĞ¸
    std::string message(int ev) const override {
        switch (static_cast<MyError>(ev)) {
            case MyError::Success: return "Success";
            case MyError::FileNotFound: return "File not found";
            case MyError::PermissionDenied: return "Permission denied";
            case MyError::NetworkError: return "Network error";
            default: return "Unknown error";
        }
    }
};

// 3. Singleton ÑĞºĞ·ĞµĞ¼Ğ¿Ğ»ÑÑ€ ĞºĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ğ¸Ğ¸
const MyErrorCategory& my_error_category() {
    static MyErrorCategory instance;
    return instance;
}

// 4. Helper Ğ´Ğ»Ñ ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ñ error_code Ğ¸Ğ· Ğ½Ğ°ÑˆĞµĞ³Ğ¾ enum
std::error_code make_error_code(MyError e) {
    return {static_cast<int>(e), my_error_category()};
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ error_code
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ error_code
std::error_code ec = make_error_code(MyError::FileNotFound);

// ĞŸĞ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğµ Ğ¸Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ğ¸ Ğ¾Ğ± Ğ¾ÑˆĞ¸Ğ±ĞºĞµ
std::string msg = ec.message();        // "File not found"
std::string cat = ec.category().name(); // "MyError"
int val = ec.value();                  // 1 (Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ enum)

// ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ½Ğ° ÑƒÑĞ¿ĞµÑ… (0 = ÑƒÑĞ¿ĞµÑ…)
if (!ec) {
    std::cout << "Success\n";
} else {
    std::cout << "Error: " << ec.message() << '\n';
}

// Ğ¡Ñ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ğµ error_code
if (ec == make_error_code(MyError::FileNotFound)) {
    std::cout << "Is FileNotFound\n";
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// Ğ˜Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ñ Ñ std::system_error (Ğ±Ñ€Ğ¾ÑĞ°ĞµĞ¼Ğ¾Ğµ Ğ¸ÑĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ)
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

void read_file_with_error_code(const std::string& path) {
    std::error_code ec = make_error_code(MyError::FileNotFound);
    
    if (ec) {
        // ĞŸÑ€ĞµĞ¾Ğ±Ñ€Ğ°Ğ·ÑƒĞµĞ¼ error_code Ğ² Ğ¸ÑĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ
        throw std::system_error(ec, "Failed to read file: " + path);
    }
}

// ĞĞ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ°:
try {
    read_file_with_error_code("data.txt");
} catch (const std::system_error& e) {
    std::cout << "Error: " << e.what() << '\n';
    std::cout << "Code: " << e.code().value() << '\n';
    std::cout << "Category: " << e.code().category().name() << '\n';
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ ÑÑ‚Ğ°Ğ½Ğ´Ğ°Ñ€Ñ‚Ğ½Ñ‹Ñ… ĞºĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ğ¸Ğ¹ Ğ¾ÑˆĞ¸Ğ±Ğ¾Ğº
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// std::generic_category - POSIX errno
std::error_code ec1(ENOENT, std::generic_category());  // "No such file or directory"
std::cout << ec1.message() << '\n';

// std::system_category - OS-specific (Windows: GetLastError, POSIX: errno)
std::error_code ec2(2, std::system_category());
std::cout << ec2.message() << '\n';

// std::iostream - Ğ¾ÑˆĞ¸Ğ±ĞºĞ¸ Ğ²Ğ²Ğ¾Ğ´Ğ°/Ğ²Ñ‹Ğ²Ğ¾Ğ´Ğ°
std::error_code ec3(std::io_errc::stream);
std::cout << ec3.message() << '\n';

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// ĞŸÑ€Ğ¸Ğ¼ĞµÑ€ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ Ñ Ñ„Ğ°Ğ¹Ğ»Ğ°Ğ¼Ğ¸ (std::filesystem)
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

#include <filesystem>

std::error_code file_ec;
bool exists = std::filesystem::exists("data.txt", file_ec);

if (file_ec) {
    std::cout << "Error checking file: " << file_ec.message() << '\n';
} else if (exists) {
    std::cout << "File exists\n";
} else {
    std::cout << "File does not exist\n";
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// ĞšĞ¾Ğ¼Ğ±Ğ¸Ğ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ error_code Ñ Ñ„ÑƒĞ½ĞºÑ†Ğ¸ÑĞ¼Ğ¸ (out-Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€)
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// Ğ’Ğ¼ĞµÑÑ‚Ğ¾ Ğ¸ÑĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğ¹ - Ğ²Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‰Ğ°ĞµĞ¼ bool, Ğ¾ÑˆĞ¸Ğ±ĞºÑƒ Ñ‡ĞµÑ€ĞµĞ· out-Ğ¿Ğ°Ñ€Ğ°Ğ¼ĞµÑ‚Ñ€
bool open_file(const std::string& path, std::error_code& ec) {
    // Ğ¡Ğ¸Ğ¼ÑƒĞ»ÑÑ†Ğ¸Ñ Ğ¾ÑˆĞ¸Ğ±ĞºĞ¸
    ec = make_error_code(MyError::FileNotFound);
    return false;
}

// Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ:
std::error_code open_ec;
if (!open_file("data.txt", open_ec)) {
    std::cout << "Failed to open: " << open_ec.message() << '\n';
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// Ğ¡Ñ€Ğ°Ğ²Ğ½ĞµĞ½Ğ¸Ğµ error_code Ñ Ğ´Ñ€ÑƒĞ³Ğ¸Ğ¼Ğ¸ Ğ¼ĞµÑ…Ğ°Ğ½Ğ¸Ğ·Ğ¼Ğ°Ğ¼Ğ¸
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

/*
 * ERROR_CODE vs EXCEPTIONS:
 * 
 * ERROR_CODE:
 * âœ“ ĞĞµÑ‚ overhead Ğ¿Ñ€Ğ¸ ÑĞ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğ¸/Ğ±Ñ€Ğ¾ÑĞ°Ğ½Ğ¸Ğ¸
 * âœ“ Ğ¯Ğ²Ğ½Ğ°Ñ Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ° (Ğ²Ğ¸Ğ´Ğ½Ğ¾ Ğ² ÑĞ¸Ğ³Ğ½Ğ°Ñ‚ÑƒÑ€Ğµ)
 * âœ“ Ğ¡Ğ¾Ğ²Ğ¼ĞµÑÑ‚Ğ¸Ğ¼Ğ¾ÑÑ‚ÑŒ Ñ C API
 * âœ“ Ğ¡Ñ‚Ğ°Ğ½Ğ´Ğ°Ñ€Ñ‚Ğ½Ñ‹Ğµ ĞºĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ğ¸Ğ¸ (generic, system, iostream)
 * âœ— ĞÑƒĞ¶Ğ½Ğ¾ ÑĞ²Ğ½Ğ¾ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ÑÑ‚ÑŒ ĞºĞ°Ğ¶Ğ´Ñ‹Ğ¹ Ñ€Ğ°Ğ·
 * âœ— Ğ›ĞµĞ³ĞºĞ¾ Ğ¿Ñ€Ğ¾Ğ¸Ğ³Ğ½Ğ¾Ñ€Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ¾ÑˆĞ¸Ğ±ĞºÑƒ
 * 
 * ERROR_CODE vs EXPECTED:
 * âœ“ Ğ¡Ñ‚Ğ°Ğ½Ğ´Ğ°Ñ€Ñ‚Ğ½Ğ°Ñ Ğ¸Ğ½Ñ„Ñ€Ğ°ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ° ĞºĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ğ¸Ğ¹
 * âœ“ Ğ˜Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ñ Ñ system_error
 * âœ— ĞœĞµĞ½ĞµĞµ type-safe (int + ĞºĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ğ¸Ñ)
 * âœ— ĞĞµÑ‚ monadic operations
 * âœ— ĞĞµĞ»ÑŒĞ·Ñ Ğ²ĞµÑ€Ğ½ÑƒÑ‚ÑŒ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ Ğ˜ Ğ¾ÑˆĞ¸Ğ±ĞºÑƒ Ğ¾Ğ´Ğ½Ğ¾Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ½Ğ¾
 */


// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ğŸ“Œ BEST PRACTICES (Ğ›Ğ£Ğ§Ğ¨Ğ˜Ğ• ĞŸĞ ĞĞšĞ¢Ğ˜ĞšĞ˜)
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

/*
 * â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
 * Ğ Ğ•ĞšĞĞœĞ•ĞĞ”ĞĞ¦Ğ˜Ğ˜ ĞŸĞ ĞĞ‘Ğ ĞĞ‘ĞĞ¢ĞšĞ• ĞĞ¨Ğ˜Ğ‘ĞĞš Ğ’ Ğ¡ĞĞ’Ğ Ğ•ĞœĞ•ĞĞĞĞœ C++
 * â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
 * 
 * 1. Ğ˜Ğ¡ĞŸĞĞ›Ğ¬Ğ—Ğ£Ğ™Ğ¢Ğ• RAII Ğ”Ğ›Ğ¯ Ğ’Ğ¡Ğ•Ğ¥ Ğ Ğ•Ğ¡Ğ£Ğ Ğ¡ĞĞ’
 *    âœ… Ğ£Ğ¼Ğ½Ñ‹Ğµ ÑƒĞºĞ°Ğ·Ğ°Ñ‚ĞµĞ»Ğ¸ (unique_ptr, shared_ptr)
 *    âœ… lock_guard, unique_lock Ğ´Ğ»Ñ Ğ¼ÑŒÑÑ‚ĞµĞºÑĞ¾Ğ²
 *    âœ… ĞšĞ°ÑÑ‚Ğ¾Ğ¼Ğ½Ñ‹Ğµ RAII wrappers Ğ´Ğ»Ñ ÑĞ¿ĞµÑ†Ğ¸Ñ„Ğ¸Ñ‡Ğ½Ñ‹Ñ… Ñ€ĞµÑÑƒÑ€ÑĞ¾Ğ²
 *    âœ… fstream Ğ´Ğ»Ñ Ñ„Ğ°Ğ¹Ğ»Ğ¾Ğ² Ğ²Ğ¼ĞµÑÑ‚Ğ¾ FILE*
 * 
 * 2. EXCEPTION SAFETY GUARANTEES
 *    âœ… Ğ”ĞµÑÑ‚Ñ€ÑƒĞºÑ‚Ğ¾Ñ€Ñ‹ Ğ’Ğ¡Ğ•Ğ“Ğ”Ğ noexcept (Ğ¿Ğ¾ ÑƒĞ¼Ğ¾Ğ»Ñ‡Ğ°Ğ½Ğ¸Ñ)
 *    âœ… Move Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸ Ğ¶ĞµĞ»Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ noexcept (Ğ´Ğ»Ñ Ğ¾Ğ¿Ñ‚Ğ¸Ğ¼Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¹ std::vector)
 *    âœ… Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞ¹Ñ‚Ğµ copy-and-swap Ğ´Ğ»Ñ strong guarantee
 *    âœ… Ğ”Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ¸Ñ€ÑƒĞ¹Ñ‚Ğµ ĞºĞ°ĞºÑƒÑ Ğ³Ğ°Ñ€Ğ°Ğ½Ñ‚Ğ¸Ñ Ğ´Ğ°Ñ‘Ñ‚ Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ñ
 * 
 * 3. Ğ›ĞĞ’Ğ˜Ğ¢Ğ• Ğ˜Ğ¡ĞšĞ›Ğ®Ğ§Ğ•ĞĞ˜Ğ¯ ĞŸĞ CONST REFERENCE
 *    âœ… catch (const std::exception& e)  // ĞŸÑ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ğ¾
 *    âŒ catch (std::exception e)         // ĞšĞ¾Ğ¿Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ + slicing
 *    âŒ catch (std::exception* e)        // ĞĞ¸ĞºĞ¾Ğ³Ğ´Ğ° Ğ½Ğµ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·ÑƒĞ¹Ñ‚Ğµ ÑƒĞºĞ°Ğ·Ğ°Ñ‚ĞµĞ»Ğ¸
 * 
 * 4. ĞĞ• Ğ‘Ğ ĞĞ¡ĞĞ™Ğ¢Ğ• Ğ˜Ğ¡ĞšĞ›Ğ®Ğ§Ğ•ĞĞ˜Ğ¯ Ğ˜Ğ—:
 *    âŒ Ğ”ĞµÑÑ‚Ñ€ÑƒĞºÑ‚Ğ¾Ñ€Ğ¾Ğ² (â†’ std::terminate)
 *    âŒ noexcept Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¹
 *    âŒ Move ĞºĞ¾Ğ½ÑÑ‚Ñ€ÑƒĞºÑ‚Ğ¾Ñ€Ğ¾Ğ²/Ğ¾Ğ¿ĞµÑ€Ğ°Ñ‚Ğ¾Ñ€Ğ¾Ğ² (ĞµÑĞ»Ğ¸ Ğ²Ğ¾Ğ·Ğ¼Ğ¾Ğ¶Ğ½Ğ¾)
 *    âŒ swap Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¹
 *    âŒ Ğ¤ÑƒĞ½ĞºÑ†Ğ¸Ğ¹ Ğ¾Ğ±Ñ€Ğ°Ñ‚Ğ½Ğ¾Ğ³Ğ¾ Ğ²Ñ‹Ğ·Ğ¾Ğ²Ğ° Ğ² C API
 * 
 * 5. Ğ’Ğ«Ğ‘ĞĞ  ĞœĞ•Ğ¥ĞĞĞ˜Ğ—ĞœĞ ĞĞ‘Ğ ĞĞ‘ĞĞ¢ĞšĞ˜ ĞĞ¨Ğ˜Ğ‘ĞĞš:
 *    EXCEPTIONS     â†’ Ğ ĞµĞ´ĞºĞ¸Ğµ Ğ¾ÑˆĞ¸Ğ±ĞºĞ¸, Ğ³Ğ»ÑƒĞ±Ğ¾ĞºĞ¸Ğ¹ call stack
 *    EXPECTED       â†’ Ğ§Ğ°ÑÑ‚Ñ‹Ğµ Ğ¾ÑˆĞ¸Ğ±ĞºĞ¸, Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ ÑÑ‚Ğ¸Ğ»ÑŒ
 *    OPTIONAL       â†’ ĞÑ‚ÑÑƒÑ‚ÑÑ‚Ğ²Ğ¸Ğµ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ñ Ğ½Ğµ Ğ¾ÑˆĞ¸Ğ±ĞºĞ°
 *    ERROR_CODE     â†’ Ğ¡Ğ¸ÑÑ‚ĞµĞ¼Ğ½Ñ‹Ğµ Ğ¾ÑˆĞ¸Ğ±ĞºĞ¸, C API
 * 
 * 6. Ğ”ĞĞšĞ£ĞœĞ•ĞĞ¢Ğ˜Ğ Ğ£Ğ™Ğ¢Ğ• ĞŸĞĞ’Ğ•Ğ”Ğ•ĞĞ˜Ğ•
 *    - ĞšĞ°ĞºĞ¸Ğµ Ğ¸ÑĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ñ Ğ¼Ğ¾Ğ¶ĞµÑ‚ Ğ±Ñ€Ğ¾ÑĞ¸Ñ‚ÑŒ Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ñ
 *    - Exception safety guarantee (basic/strong/nothrow)
 *    - Ğ£ÑĞ»Ğ¾Ğ²Ğ¸Ñ Ğ´Ğ»Ñ std::expected (Ñ‡Ñ‚Ğ¾ ÑÑ‡Ğ¸Ñ‚Ğ°ĞµÑ‚ÑÑ Ğ¾ÑˆĞ¸Ğ±ĞºĞ¾Ğ¹)
 *    - Ğ§Ñ‚Ğ¾ Ğ¾Ğ·Ğ½Ğ°Ñ‡Ğ°ĞµÑ‚ std::nullopt Ğ´Ğ»Ñ optional
 * 
 * 7. ĞĞ• Ğ˜Ğ¡ĞŸĞĞ›Ğ¬Ğ—Ğ£Ğ™Ğ¢Ğ• DEPRECATED FEATURES
 *    âŒ throw(Type)              // Deprecated Ğ² C++11, ÑƒĞ´Ğ°Ğ»ĞµĞ½Ğ¾ Ğ² C++17
 *    âŒ std::unexpected()        // Deprecated
 *    âœ… noexcept                 // Ğ•Ğ´Ğ¸Ğ½ÑÑ‚Ğ²ĞµĞ½Ğ½Ğ°Ñ exception specification
 *    âœ… noexcept(expression)     // Conditional noexcept
 */

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// âœ… ĞŸĞ ĞĞ’Ğ˜Ğ›Ğ¬ĞĞĞ¯ ĞĞ‘Ğ ĞĞ‘ĞĞ¢ĞšĞ ĞĞ¨Ğ˜Ğ‘ĞĞš Ğ¡ Ğ˜Ğ¡ĞšĞ›Ğ®Ğ§Ğ•ĞĞ˜Ğ¯ĞœĞ˜
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

class DataProcessor {
    std::vector<int> buffer_;
    
public:
    // âœ… Ğ”Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ°, strong exception safety
    // Ğ‘Ñ€Ğ¾ÑĞ°ĞµÑ‚: std::invalid_argument ĞµÑĞ»Ğ¸ Ğ¾Ñ‚Ñ€Ğ¸Ñ†Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ñ‹Ğµ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ñ
    std::vector<int> process(const std::vector<int>& input) {
        std::vector<int> result;
        result.reserve(input.size());  // Strong guarantee: reserve Ğ´Ğ¾ Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ğ¹
        
        for (int val : input) {
            if (val < 0) {
                throw std::invalid_argument("Negative values not allowed");
            }
            result.push_back(val * 2);
        }
        
        return result;  // NRVO (Named Return Value Optimization)
    }
    
    // âœ… Move Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸ noexcept Ğ´Ğ»Ñ Ğ¾Ğ¿Ñ‚Ğ¸Ğ¼Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¹
    DataProcessor(DataProcessor&&) noexcept = default;
    DataProcessor& operator=(DataProcessor&&) noexcept = default;
    
    // âœ… Ğ”ĞµÑÑ‚Ñ€ÑƒĞºÑ‚Ğ¾Ñ€ noexcept (Ğ¿Ğ¾ ÑƒĞ¼Ğ¾Ğ»Ñ‡Ğ°Ğ½Ğ¸Ñ)
    ~DataProcessor() noexcept = default;
};

// Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ:
DataProcessor processor;

try {
    auto result = processor.process({1, 2, 3});
    std::cout << "Processed " << result.size() << " elements\n";
    
} catch (const std::invalid_argument& e) {  // âœ… ĞŸĞ¾ const reference
    std::cerr << "Error: " << e.what() << '\n';
    // ĞĞ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ° Ğ¾ÑˆĞ¸Ğ±ĞºĞ¸
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// âœ… ĞŸĞ ĞĞ’Ğ˜Ğ›Ğ¬ĞĞĞ¯ ĞĞ‘Ğ ĞĞ‘ĞĞ¢ĞšĞ Ğ¡ std::expected
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

class SafeDataProcessor {
public:
    // âœ… Ğ¡ expected - Ğ±ĞµĞ· Ğ¸ÑĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğ¹, ÑĞ²Ğ½Ğ°Ñ ÑĞ¸Ğ³Ğ½Ğ°Ñ‚ÑƒÑ€Ğ°
    std::expected<std::vector<int>, std::string> 
    process_safe(const std::vector<int>& input) {
        std::vector<int> result;
        result.reserve(input.size());
        
        for (int val : input) {
            if (val < 0) {
                return std::unexpected("Negative values not allowed");
            }
            result.push_back(val * 2);
        }
        
        return result;  // Ğ£ÑĞ¿ĞµÑ…
    }
};

// Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ:
SafeDataProcessor safe_processor;

auto result = safe_processor.process_safe({1, -2, 3});
if (!result) {
    std::cerr << "Error: " << result.error() << '\n';
} else {
    std::cout << "Processed " << result->size() << " elements\n";
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// âŒ Ğ¢Ğ˜ĞŸĞ˜Ğ§ĞĞ«Ğ• ĞĞ¨Ğ˜Ğ‘ĞšĞ˜
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// âŒ ĞĞ¨Ğ˜Ğ‘ĞšĞ 1: Ğ£Ñ‚ĞµÑ‡ĞºĞ° Ñ€ĞµÑÑƒÑ€ÑĞ¾Ğ² Ğ¿Ñ€Ğ¸ Ğ¸ÑĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğ¸
void bad_resource_handling() {
    int* data = new int[100];
    
    // Ğ•ÑĞ»Ğ¸ Ğ·Ğ´ĞµÑÑŒ Ğ¸ÑĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ â†’ ÑƒÑ‚ĞµÑ‡ĞºĞ°!
    // process(data);
    
    delete[] data;  // ĞœĞ¾Ğ¶ĞµÑ‚ Ğ½Ğµ Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½Ğ¸Ñ‚ÑŒÑÑ
}

// âœ… ĞŸĞ ĞĞ’Ğ˜Ğ›Ğ¬ĞĞ: RAII
void good_resource_handling() {
    auto data = std::make_unique<int[]>(100);
    
    // Ğ˜ÑĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ? Ğ”ĞµÑÑ‚Ñ€ÑƒĞºÑ‚Ğ¾Ñ€ unique_ptr Ğ¾ÑĞ²Ğ¾Ğ±Ğ¾Ğ´Ğ¸Ñ‚ Ğ¿Ğ°Ğ¼ÑÑ‚ÑŒ
    // process(data.get());
}

// âŒ ĞĞ¨Ğ˜Ğ‘ĞšĞ 2: Ğ‘Ñ€Ğ¾ÑĞ°Ğ½Ğ¸Ğµ Ğ¸Ğ· Ğ´ĞµÑÑ‚Ñ€ÑƒĞºÑ‚Ğ¾Ñ€Ğ°
class BadClass {
    ~BadClass() {
        // âŒ ĞĞ˜ĞšĞĞ“Ğ”Ğ Ğ½Ğµ Ğ±Ñ€Ğ¾ÑĞ°Ğ¹Ñ‚Ğµ Ğ¸Ğ· Ğ´ĞµÑÑ‚Ñ€ÑƒĞºÑ‚Ğ¾Ñ€Ğ°!
        // throw std::runtime_error("Error");  // â†’ std::terminate()
    }
};

// âœ… ĞŸĞ ĞĞ’Ğ˜Ğ›Ğ¬ĞĞ: Ğ”ĞµÑÑ‚Ñ€ÑƒĞºÑ‚Ğ¾Ñ€ noexcept
class GoodClass {
    ~GoodClass() noexcept {  // Ğ¯Ğ²Ğ½Ğ¾ Ğ¸Ğ»Ğ¸ Ğ¿Ğ¾ ÑƒĞ¼Ğ¾Ğ»Ñ‡Ğ°Ğ½Ğ¸Ñ
        try {
            // Ğ Ğ¸ÑĞºĞ¾Ğ²Ğ°Ğ½Ğ½Ğ°Ñ Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸Ñ
        } catch (...) {
            // ĞŸĞ¾Ğ³Ğ»Ğ¾Ñ‰Ğ°ĞµĞ¼ Ğ¸ÑĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ, Ğ»Ğ¾Ğ³Ğ¸Ñ€ÑƒĞµĞ¼
            std::cerr << "Error in destructor\n";
        }
    }
};

// âŒ ĞĞ¨Ğ˜Ğ‘ĞšĞ 3: Ğ›Ğ¾Ğ²Ğ»Ñ Ğ¿Ğ¾ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ñ (slicing)
try {
    throw std::runtime_error("Error");
} catch (std::exception e) {  // âŒ ĞšĞ¾Ğ¿Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ + slicing
    std::cout << e.what() << '\n';
}

// âœ… ĞŸĞ ĞĞ’Ğ˜Ğ›Ğ¬ĞĞ: Ğ›Ğ¾Ğ²Ğ»Ñ Ğ¿Ğ¾ const reference
try {
    throw std::runtime_error("Error");
} catch (const std::exception& e) {  // âœ… ĞĞµÑ‚ ĞºĞ¾Ğ¿Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ, Ğ½ĞµÑ‚ slicing
    std::cout << e.what() << '\n';
}

// âŒ ĞĞ¨Ğ˜Ğ‘ĞšĞ 4: Ğ˜Ğ³Ğ½Ğ¾Ñ€Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ¾ÑˆĞ¸Ğ±Ğ¾Ğº
std::error_code ec;
std::filesystem::remove("file.txt", ec);
// âŒ ĞĞµ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€Ğ¸Ğ»Ğ¸ ec!

// âœ… ĞŸĞ ĞĞ’Ğ˜Ğ›Ğ¬ĞĞ: Ğ’ÑĞµĞ³Ğ´Ğ° Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ÑĞ¹Ñ‚Ğµ
std::error_code ec2;
std::filesystem::remove("file.txt", ec2);
if (ec2) {
    std::cerr << "Failed to remove: " << ec2.message() << '\n';
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// ĞœĞĞ¢Ğ Ğ˜Ğ¦Ğ Ğ’Ğ«Ğ‘ĞĞ Ğ ĞœĞ•Ğ¥ĞĞĞ˜Ğ—ĞœĞ ĞĞ‘Ğ ĞĞ‘ĞĞ¢ĞšĞ˜ ĞĞ¨Ğ˜Ğ‘ĞĞš
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

/*
 * â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
 * â”‚ Ğ¡Ğ˜Ğ¢Ğ£ĞĞ¦Ğ˜Ğ¯                          â”‚ Ğ˜Ğ¡ĞŸĞĞ›Ğ¬Ğ—Ğ£Ğ™Ğ¢Ğ•                            â”‚
 * â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
 * â”‚ ĞÑˆĞ¸Ğ±ĞºĞ° Ñ€ĞµĞ´ĞºĞ°Ñ (< 1%)              â”‚ EXCEPTIONS                             â”‚
 * â”‚ Ğ“Ğ»ÑƒĞ±Ğ¾ĞºĞ¸Ğ¹ call stack               â”‚ EXCEPTIONS                             â”‚
 * â”‚ ĞÑƒĞ¶ĞµĞ½ Ğ°Ğ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹ cleanup      â”‚ EXCEPTIONS + RAII                      â”‚
 * â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
 * â”‚ ĞÑˆĞ¸Ğ±ĞºĞ° Ñ‡Ğ°ÑÑ‚Ğ°Ñ (> 10%)             â”‚ EXPECTED<T, E>                         â”‚
 * â”‚ Ğ¤ÑƒĞ½ĞºÑ†Ğ¸Ğ¾Ğ½Ğ°Ğ»ÑŒĞ½Ñ‹Ğ¹ ÑÑ‚Ğ¸Ğ»ÑŒ              â”‚ EXPECTED + monadic ops                 â”‚
 * â”‚ ĞŸÑ€ĞµĞ´ÑĞºĞ°Ğ·ÑƒĞµĞ¼Ğ°Ñ Ğ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ  â”‚ EXPECTED                               â”‚
 * â”‚ Type-safe ĞºĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ğ¸Ğ¸ Ğ¾ÑˆĞ¸Ğ±Ğ¾Ğº        â”‚ EXPECTED<T, ErrorEnum>                 â”‚
 * â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
 * â”‚ ĞÑ‚ÑÑƒÑ‚ÑÑ‚Ğ²Ğ¸Ğµ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ñ - Ğ½Ğ¾Ñ€Ğ¼Ğ°       â”‚ OPTIONAL<T>                            â”‚
 * â”‚ Nullable Ñ‚Ğ¸Ğ¿Ñ‹                     â”‚ OPTIONAL<T>                            â”‚
 * â”‚ ĞĞµÑ‚ Ğ¿Ñ€Ğ¸Ñ‡Ğ¸Ğ½Ñ‹ Ğ¾Ñ‚ÑÑƒÑ‚ÑÑ‚Ğ²Ğ¸Ñ            â”‚ OPTIONAL<T>                            â”‚
 * â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
 * â”‚ Ğ˜Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ñ Ñ C API                â”‚ ERROR_CODE                             â”‚
 * â”‚ Ğ¡Ğ¸ÑÑ‚ĞµĞ¼Ğ½Ñ‹Ğµ Ğ¾ÑˆĞ¸Ğ±ĞºĞ¸ (errno)          â”‚ ERROR_CODE                             â”‚
 * â”‚ Ğ¡Ñ‚Ğ°Ğ½Ğ´Ğ°Ñ€Ñ‚Ğ½Ñ‹Ğµ ĞºĞ°Ñ‚ĞµĞ³Ğ¾Ñ€Ğ¸Ğ¸             â”‚ ERROR_CODE                             â”‚
 * â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
 */

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// ĞŸĞ Ğ˜ĞœĞ•Ğ : ĞšĞ¾Ğ¼Ğ¿Ğ»ĞµĞºÑĞ½Ğ°Ñ Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ñ Ñ Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ğ¾Ğ¹ Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ¾Ğ¹ Ğ¾ÑˆĞ¸Ğ±Ğ¾Ğº
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

class FileProcessor {
public:
    // Ğ’Ğ°Ñ€Ğ¸Ğ°Ğ½Ñ‚ 1: Ğ¡ Ğ¸ÑĞºĞ»ÑÑ‡ĞµĞ½Ğ¸ÑĞ¼Ğ¸ (Ğ´Ğ»Ñ Ñ€ĞµĞ´ĞºĞ¸Ñ… Ğ¾ÑˆĞ¸Ğ±Ğ¾Ğº)
    std::string read_and_process_exception(const std::string& path) {
        std::ifstream file(path);
        if (!file) {
            throw std::runtime_error("Cannot open file: " + path);
        }
        
        std::string content((std::istreambuf_iterator<char>(file)),
                            std::istreambuf_iterator<char>());
        
        if (content.empty()) {
            throw std::runtime_error("Empty file");
        }
        
        // ĞĞ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ°...
        return content;
    }
    
    // Ğ’Ğ°Ñ€Ğ¸Ğ°Ğ½Ñ‚ 2: Ğ¡ expected (Ğ´Ğ»Ñ Ñ‡Ğ°ÑÑ‚Ñ‹Ñ… Ğ¾ÑˆĞ¸Ğ±Ğ¾Ğº)
    std::expected<std::string, std::string> 
    read_and_process_expected(const std::string& path) {
        std::ifstream file(path);
        if (!file) {
            return std::unexpected("Cannot open file: " + path);
        }
        
        std::string content((std::istreambuf_iterator<char>(file)),
                            std::istreambuf_iterator<char>());
        
        if (content.empty()) {
            return std::unexpected("Empty file");
        }
        
        // ĞĞ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ°...
        return content;
    }
    
    // Ğ’Ğ°Ñ€Ğ¸Ğ°Ğ½Ñ‚ 3: Ğ¡ optional (Ğ¾Ñ‚ÑÑƒÑ‚ÑÑ‚Ğ²Ğ¸Ğµ Ñ„Ğ°Ğ¹Ğ»Ğ° - Ğ½Ğ¾Ñ€Ğ¼Ğ°)
    std::optional<std::string> 
    try_read_config(const std::string& path) {
        std::ifstream file(path);
        if (!file) {
            return std::nullopt;  // ĞŸÑ€Ğ¾ÑÑ‚Ğ¾ Ğ½ĞµÑ‚ Ñ„Ğ°Ğ¹Ğ»Ğ°
        }
        
        std::string content((std::istreambuf_iterator<char>(file)),
                            std::istreambuf_iterator<char>());
        
        return content;
    }
};

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// ĞšĞĞĞ¢Ğ ĞĞ›Ğ¬ĞĞ«Ğ™ Ğ¡ĞŸĞ˜Ğ¡ĞĞš (CHECKLIST)
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

/*
 * ĞŸĞ•Ğ Ğ•Ğ” ĞšĞĞœĞœĞ˜Ğ¢ĞĞœ ĞŸĞ ĞĞ’Ğ•Ğ Ğ¬Ğ¢Ğ•:
 * 
 * â–¡ Ğ’ÑĞµ Ñ€ĞµÑÑƒÑ€ÑÑ‹ ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»ÑÑÑ‚ÑÑ Ñ‡ĞµÑ€ĞµĞ· RAII (Ğ½ĞµÑ‚ Ñ€ÑƒÑ‡Ğ½Ñ‹Ñ… new/delete/fopen/fclose)
 * â–¡ Ğ”ĞµÑÑ‚Ñ€ÑƒĞºÑ‚Ğ¾Ñ€Ñ‹ noexcept (Ğ¸Ğ»Ğ¸ ÑĞ¾Ğ´ĞµÑ€Ğ¶Ğ°Ñ‚ Ñ‚Ğ¾Ğ»ÑŒĞºĞ¾ noexcept Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸)
 * â–¡ Move Ğ¾Ğ¿ĞµÑ€Ğ°Ñ†Ğ¸Ğ¸ noexcept Ğ³Ğ´Ğµ Ğ²Ğ¾Ğ·Ğ¼Ğ¾Ğ¶Ğ½Ğ¾
 * â–¡ Ğ˜ÑĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ñ Ğ»Ğ¾Ğ²ÑÑ‚ÑÑ Ğ¿Ğ¾ const reference
 * â–¡ Ğ”Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ñ‹ Ğ±Ñ€Ğ¾ÑĞ°ĞµĞ¼Ñ‹Ğµ Ğ¸ÑĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ñ
 * â–¡ Ğ”Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ñ‹ exception safety guarantees
 * â–¡ error_code/expected Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ÑÑÑ‚ÑÑ Ğ¿ĞµÑ€ĞµĞ´ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸ĞµĞ¼
 * â–¡ ĞĞµÑ‚ Ğ¿ÑƒÑÑ‚Ñ‹Ñ… catch Ğ±Ğ»Ğ¾ĞºĞ¾Ğ² (catch(...) {})
 * â–¡ ĞĞµÑ‚ deprecated exception specifications
 * â–¡ Ğ’Ñ‹Ğ±Ñ€Ğ°Ğ½ Ğ¿Ñ€Ğ°Ğ²Ğ¸Ğ»ÑŒĞ½Ñ‹Ğ¹ Ğ¼ĞµÑ…Ğ°Ğ½Ğ¸Ğ·Ğ¼ Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ¸ Ğ¾ÑˆĞ¸Ğ±Ğ¾Ğº Ğ´Ğ»Ñ ĞºĞ°Ğ¶Ğ´Ğ¾Ğ³Ğ¾ ÑĞ»ÑƒÑ‡Ğ°Ñ
 */
